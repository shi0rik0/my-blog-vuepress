import{_ as e,c as t,d as s,o as p}from"./app-D9VVartN.js";const n={};function a(c,o){return p(),t("div",null,[...o[0]||(o[0]=[s(`<h1 id="理清python的包管理系统" tabindex="-1"><a class="header-anchor" href="#理清python的包管理系统"><span>理清Python的包管理系统</span></a></h1><p>现代的编程语言都会提供官方的包管理系统，例如 Rust 的 Cargo、Node.js 的 npm、Go 的 go mod 等等。Python 也不例外，但是 Python 的包管理系统非常的混乱，这里主要介绍一下 pip 和 setuptools 这两个工具。</p><h2 id="pip-和-setuptools-的关系" tabindex="-1"><a class="header-anchor" href="#pip-和-setuptools-的关系"><span>pip 和 setuptools 的关系</span></a></h2><p>setuptools 是 Python 的<strong>构建和打包工具</strong>，它负责构建 Python 项目，并将其打包成一个 wheel 文件，而 pip 是 Python 的<strong>包管理工具</strong>，它可以直接安装 wheel 文件，也可以调用 setuptools 来打包项目并安装。pip 还负责管理包的依赖关系，它会在安装包的时候自动安装依赖。</p><p>setuptools 并不是 Python 官方支持的唯一打包工具，但它是最流行的，并且它的功能已经足够使用了，所以大部分 Python 项目都使用 setuptools 来打包项目。</p><h2 id="python-项目的配置文件" tabindex="-1"><a class="header-anchor" href="#python-项目的配置文件"><span>Python 项目的配置文件</span></a></h2><p>由于历史问题，Python 项目的配置文件非常混乱，主要有 3 个：<code>setup.py</code>、<code>setup.cfg</code>和<code>pyproject.toml</code>。其中<code>setup.py</code>和<code>setup.cfg</code>是 setuptools 的配置文件。它们的区别在于，<code>setup.py</code>就是一个 Python 脚本，setuptools 会执行这个脚本，并根据脚本的变量值来配置项目。后来，setuptools 的维护者们认为这么做一方面不安全（因为脚本可以执行恶意代码），一方面也过于动态也会影响可复现性，所以他们引入了<code>setup.cfg</code>这个静态配置文件，一部分<code>setup.py</code>的配置可以通过<code>setup.cfg</code>来配置。而<code>pyproject.toml</code>是 PEP 518 提出的，它的目标是统一 Python 项目的配置文件，因为 Python 的打包工具不止 setuptools 一个，并且一个 Python 项目除了打包工具之外，还可能有其他需要配置的工具，例如 linters、formatters 等等。<code>pyproject.toml</code>是一个 TOML 格式的配置文件，Python 官方希望所有的工具都使用这个配置文件来配置项目，所以 setuptools 自然也跟进了，现在 setuptools 的配置也可以写在<code>pyproject.toml</code>中。</p><p>这里总结一下，<code>pyproject.toml</code>是一个统一的配置文件，可以配置任何工具，而<code>setup.py</code>和<code>setup.cfg</code>是 setuptools 的配置文件，用来配置 setuptools。</p><p>如果只是配置 setuptools，那么这 3 个都可以，但是<code>setup.py</code>明显是最灵活最强大的，所以我还是喜欢使用<code>setup.py</code>。又因为 Python 官方推荐使用<code>pyproject.toml</code>，所以我会在项目中同时使用<code>setup.py</code>和<code>pyproject.toml</code>，<code>setup.py</code>只负责配置 setuptools，而<code>pyproject.toml</code>主要负责指定项目的打包工具是 setuptools，以及配置其他工具。</p><p>下面的<code>pyproject.toml</code>会告诉 pip 使用 setuptools 来打包项目。一个 Python 项目的<code>pyproject.toml</code>至少要包含这些内容：</p><div class="language-toml line-numbers-mode" data-highlighter="prismjs" data-ext="toml"><pre><code><span class="line"><span class="token punctuation">[</span><span class="token table class-name">build-system</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token key property">requires</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;setuptools &gt;= 61.0&quot;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token key property">build-backend</span> <span class="token punctuation">=</span> <span class="token string">&quot;setuptools.build_meta&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这样一来，通过 pip 从源码安装包的时候，pip 就会调用 setuptools 来打包项目，而 setuptools 会综合<code>setup.py</code>、<code>setup.cfg</code>和<code>pyproject.toml</code>的配置来打包项目。</p>`,12)])])}const d=e(n,[["render",a]]),i=JSON.parse('{"path":"/posts/2025/01/python-packaging.html","title":"理清Python的包管理系统","lang":"zh-CN","frontmatter":{"date":"2025-01-05T00:00:00.000Z"},"headers":[{"level":2,"title":"pip 和 setuptools 的关系","slug":"pip-和-setuptools-的关系","link":"#pip-和-setuptools-的关系","children":[]},{"level":2,"title":"Python 项目的配置文件","slug":"python-项目的配置文件","link":"#python-项目的配置文件","children":[]}],"git":{"updatedTime":1763699399000,"contributors":[{"name":"shi0rik0","username":"shi0rik0","email":"anguuan@outlook.com","commits":2,"url":"https://github.com/shi0rik0"}],"changelog":[{"hash":"35d50711ef3a591a2383977aa02873c707aa5c1e","time":1763699399000,"email":"anguuan@outlook.com","author":"shi0rik0","message":"Organize files by date"},{"hash":"27621ea60c6645dc9e44007e7ab6fd2858c37eaf","time":1763698804000,"email":"anguuan@outlook.com","author":"shi0rik0","message":"Migrate posts"}]},"filePathRelative":"posts/2025/01/python-packaging.md","excerpt":"\\n<p>现代的编程语言都会提供官方的包管理系统，例如 Rust 的 Cargo、Node.js 的 npm、Go 的 go mod 等等。Python 也不例外，但是 Python 的包管理系统非常的混乱，这里主要介绍一下 pip 和 setuptools 这两个工具。</p>\\n<h2>pip 和 setuptools 的关系</h2>\\n<p>setuptools 是 Python 的<strong>构建和打包工具</strong>，它负责构建 Python 项目，并将其打包成一个 wheel 文件，而 pip 是 Python 的<strong>包管理工具</strong>，它可以直接安装 wheel 文件，也可以调用 setuptools 来打包项目并安装。pip 还负责管理包的依赖关系，它会在安装包的时候自动安装依赖。</p>"}');export{d as comp,i as data};
