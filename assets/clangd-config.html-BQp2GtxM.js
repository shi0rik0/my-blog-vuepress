import{_ as a,c as n,d as c,o as s}from"./app-DDoPRsSr.js";const o={};function l(d,e){return s(),n("div",null,[...e[0]||(e[0]=[c(`<h1 id="关于clangd的配置文件" tabindex="-1"><a class="header-anchor" href="#关于clangd的配置文件"><span>关于clangd的配置文件</span></a></h1><p>clangd 是一个可以分析 C++代码，并帮助编辑器进行代码补全、跳转等功能的工具，但是 clangd 不会自动分析项目的 include 路径、编译选项等信息，这些信息需要通过配置文件来提供。clangd 支持两种配置文件，第一种是<code>compile_commands.json</code>，这个文件会给项目中的每一个源文件分别指定编译选项，通常这个文件是由程序自动生成的。第二种则是<code>compile_flags.txt</code>，这个文件会给项目中的所有文件指定相同的编译选项，这个文件往往是手动编写的。</p><h2 id="配置文件的查找路径" tabindex="-1"><a class="header-anchor" href="#配置文件的查找路径"><span>配置文件的查找路径</span></a></h2><p>clangd 的文档写得不是很清楚，根据我所了解的信息，clangd 查找配置文件的逻辑大概是这样的：</p><p>如果使用的是<code>compile_flags.txt</code>，那么 clangd 只会在项目根目录下查找这个文件。如果使用的是<code>compile_commands.json</code>，那么 clangd 会从当前编辑的源文件所在的目录开始，逐级向上查找<code>compile_commands.json</code>，并且途中也会在每一个目录的<code>build/</code>目录下查找。举个例子，假如当前编辑的文件是<code>/app/src/foo.cpp</code>，那么 clangd 会依次在以下目录查找：<code>/app/src/</code>、<code>/app/src/build/</code>、<code>/app/</code>、<code>/app/build/</code>……。目前似乎没有办法手动指定配置文件的路径。</p><h2 id="compile-flags-txt-的格式" tabindex="-1"><a class="header-anchor" href="#compile-flags-txt-的格式"><span>compile_flags.txt 的格式</span></a></h2><p><code>compile_flags.txt</code>的格式非常简单，只需要在每一行写一个<code>clang</code>的编译选项即可。例如：</p><div class="language-txt line-numbers-mode" data-highlighter="prismjs" data-ext="txt"><pre><code><span class="line">-I/usr/include</span>
<span class="line">-std=c++17</span>
<span class="line">-Wall</span>
<span class="line">-Wextra</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="使用-cmake-生成-compile-commands-json" tabindex="-1"><a class="header-anchor" href="#使用-cmake-生成-compile-commands-json"><span>使用 CMake 生成 compile_commands.json</span></a></h2><p>要使用 CMake 生成<code>compile_commands.json</code>，只需要在<code>CMakeLists.txt</code>中启用该功能即可：</p><div class="language-cmake line-numbers-mode" data-highlighter="prismjs" data-ext="cmake"><pre><code><span class="line"><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token variable">CMAKE_EXPORT_COMPILE_COMMANDS</span> <span class="token boolean">ON</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>这样在构建项目的时候，CMake 就会在生成目录（通常是<code>build/</code>）下面生成<code>compile_commands.json</code>文件。</p><h2 id="使用-bear-生成-compile-commands-json" tabindex="-1"><a class="header-anchor" href="#使用-bear-生成-compile-commands-json"><span>使用 Bear 生成 compile_commands.json</span></a></h2><p>对于使用传统的 Makefile 构建的项目，可以使用<a href="https://github.com/rizsotto/Bear" target="_blank" rel="noopener noreferrer">Bear 工具</a>来生成<code>compile_commands.json</code>。在 Ubuntu 下，Bear 可以通过 APT 安装，包名为<code>bear</code>。</p>`,14)])])}const t=a(o,[["render",l]]),p=JSON.parse('{"path":"/posts/clangd-config.html","title":"关于clangd的配置文件","lang":"zh-CN","frontmatter":{"date":"2024-12-18T00:00:00.000Z"},"headers":[{"level":2,"title":"配置文件的查找路径","slug":"配置文件的查找路径","link":"#配置文件的查找路径","children":[]},{"level":2,"title":"compile_flags.txt 的格式","slug":"compile-flags-txt-的格式","link":"#compile-flags-txt-的格式","children":[]},{"level":2,"title":"使用 CMake 生成 compile_commands.json","slug":"使用-cmake-生成-compile-commands-json","link":"#使用-cmake-生成-compile-commands-json","children":[]},{"level":2,"title":"使用 Bear 生成 compile_commands.json","slug":"使用-bear-生成-compile-commands-json","link":"#使用-bear-生成-compile-commands-json","children":[]}],"git":{"updatedTime":1763698804000,"contributors":[{"name":"shi0rik0","username":"shi0rik0","email":"anguuan@outlook.com","commits":1,"url":"https://github.com/shi0rik0"}],"changelog":[{"hash":"27621ea60c6645dc9e44007e7ab6fd2858c37eaf","time":1763698804000,"email":"anguuan@outlook.com","author":"shi0rik0","message":"Migrate posts"}]},"filePathRelative":"posts/clangd-config.md","excerpt":"\\n<p>clangd 是一个可以分析 C++代码，并帮助编辑器进行代码补全、跳转等功能的工具，但是 clangd 不会自动分析项目的 include 路径、编译选项等信息，这些信息需要通过配置文件来提供。clangd 支持两种配置文件，第一种是<code>compile_commands.json</code>，这个文件会给项目中的每一个源文件分别指定编译选项，通常这个文件是由程序自动生成的。第二种则是<code>compile_flags.txt</code>，这个文件会给项目中的所有文件指定相同的编译选项，这个文件往往是手动编写的。</p>\\n<h2>配置文件的查找路径</h2>\\n<p>clangd 的文档写得不是很清楚，根据我所了解的信息，clangd 查找配置文件的逻辑大概是这样的：</p>"}');export{t as comp,p as data};
