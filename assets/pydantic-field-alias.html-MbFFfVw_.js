import{_ as s,c as a,d as e,o as p}from"./app-D9VVartN.js";const l={};function t(i,n){return p(),a("div",null,[...n[0]||(n[0]=[e(`<h1 id="关于pydantic-model字段的别名" tabindex="-1"><a class="header-anchor" href="#关于pydantic-model字段的别名"><span>关于Pydantic model字段的别名</span></a></h1><h2 id="给-model-字段指定别名" tabindex="-1"><a class="header-anchor" href="#给-model-字段指定别名"><span>给 model 字段指定别名</span></a></h2><p>Pydantic 的 model 字段名是通过 Python 的类型注解设定的。这样一来当 schema 的字段名不是合法的 Python 变量名的时候就会带来问题。这种情况下可以用 Field 对象的 alias 属性来给字段指定名称。例如下面的例子给<code>family_name</code>这个字段设定了别名<code>family-name</code>。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> pydantic <span class="token keyword">import</span> BaseModel<span class="token punctuation">,</span> Field</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    family_name<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> Field<span class="token punctuation">(</span>alias<span class="token operator">=</span><span class="token string">&#39;family-name&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">json_str <span class="token operator">=</span> <span class="token string">&#39;{&quot;family-name&quot;: &quot;Smith&quot;}&#39;</span></span>
<span class="line">person <span class="token operator">=</span> Person<span class="token punctuation">.</span>model_validate_json<span class="token punctuation">(</span>json_str<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>model_dump_json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面的代码输出为：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">{&quot;family_name&quot;:&quot;Smith&quot;}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>可见，默认设置下 Pydantic 输出时会使用本名而非别名。如果希望使用别名，可以设置参数<code>by_alias=True</code>，也就是把代码最后一行改成：</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>model_dump_json<span class="token punctuation">(</span>by_alias<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="使用-alias-generator-自动生成别名" tabindex="-1"><a class="header-anchor" href="#使用-alias-generator-自动生成别名"><span>使用 alias generator 自动生成别名</span></a></h2><p>当一个 model 包含很多字段的时候，逐个手动填写别名就会很麻烦。这时候可以用 alias generator 自动生成别名。一个最简单的 alias generator 就是一个 str-&gt;str 的函数。通过设置 model 的 alias generator 参数就可以自动生成别名：</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> pydantic <span class="token keyword">import</span> BaseModel<span class="token punctuation">,</span> ConfigDict</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">my_alias_generator</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">return</span> name<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&#39;_&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;-&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    model_config <span class="token operator">=</span> ConfigDict<span class="token punctuation">(</span>alias_generator<span class="token operator">=</span>my_alias_generator<span class="token punctuation">)</span></span>
<span class="line">    family_name<span class="token punctuation">:</span> <span class="token builtin">str</span></span>
<span class="line">    given_name<span class="token punctuation">:</span> <span class="token builtin">str</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">json_str <span class="token operator">=</span> <span class="token string">&#39;{&quot;family-name&quot;: &quot;Smith&quot;, &quot;given-name&quot;: &quot;Alice&quot;}&#39;</span></span>
<span class="line">person <span class="token operator">=</span> Person<span class="token punctuation">.</span>model_validate_json<span class="token punctuation">(</span>json_str<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>model_dump_json<span class="token punctuation">(</span>by_alias<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>pydantic.alias_generators</code>模块中已经提供了一些常见的 alias generator，可以直接使用。</p>`,12)])])}const c=s(l,[["render",t]]),r=JSON.parse(`{"path":"/posts/2024/06/pydantic-field-alias.html","title":"关于Pydantic model字段的别名","lang":"zh-CN","frontmatter":{"date":"2024-06-22T00:00:00.000Z"},"headers":[{"level":2,"title":"给 model 字段指定别名","slug":"给-model-字段指定别名","link":"#给-model-字段指定别名","children":[]},{"level":2,"title":"使用 alias generator 自动生成别名","slug":"使用-alias-generator-自动生成别名","link":"#使用-alias-generator-自动生成别名","children":[]}],"git":{"updatedTime":1763699399000,"contributors":[{"name":"shi0rik0","username":"shi0rik0","email":"anguuan@outlook.com","commits":2,"url":"https://github.com/shi0rik0"}],"changelog":[{"hash":"35d50711ef3a591a2383977aa02873c707aa5c1e","time":1763699399000,"email":"anguuan@outlook.com","author":"shi0rik0","message":"Organize files by date"},{"hash":"27621ea60c6645dc9e44007e7ab6fd2858c37eaf","time":1763698804000,"email":"anguuan@outlook.com","author":"shi0rik0","message":"Migrate posts"}]},"filePathRelative":"posts/2024/06/pydantic-field-alias.md","excerpt":"\\n<h2>给 model 字段指定别名</h2>\\n<p>Pydantic 的 model 字段名是通过 Python 的类型注解设定的。这样一来当 schema 的字段名不是合法的 Python 变量名的时候就会带来问题。这种情况下可以用 Field 对象的 alias 属性来给字段指定名称。例如下面的例子给<code>family_name</code>这个字段设定了别名<code>family-name</code>。</p>\\n<div class=\\"language-python line-numbers-mode\\" data-highlighter=\\"prismjs\\" data-ext=\\"py\\"><pre><code><span class=\\"line\\"><span class=\\"token keyword\\">from</span> pydantic <span class=\\"token keyword\\">import</span> BaseModel<span class=\\"token punctuation\\">,</span> Field</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token keyword\\">class</span> <span class=\\"token class-name\\">Person</span><span class=\\"token punctuation\\">(</span>BaseModel<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">:</span></span>\\n<span class=\\"line\\">    family_name<span class=\\"token punctuation\\">:</span> <span class=\\"token builtin\\">str</span> <span class=\\"token operator\\">=</span> Field<span class=\\"token punctuation\\">(</span>alias<span class=\\"token operator\\">=</span><span class=\\"token string\\">'family-name'</span><span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\">json_str <span class=\\"token operator\\">=</span> <span class=\\"token string\\">'{\\"family-name\\": \\"Smith\\"}'</span></span>\\n<span class=\\"line\\">person <span class=\\"token operator\\">=</span> Person<span class=\\"token punctuation\\">.</span>model_validate_json<span class=\\"token punctuation\\">(</span>json_str<span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\"><span class=\\"token keyword\\">print</span><span class=\\"token punctuation\\">(</span>person<span class=\\"token punctuation\\">.</span>model_dump_json<span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\"></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>"}`);export{c as comp,r as data};
