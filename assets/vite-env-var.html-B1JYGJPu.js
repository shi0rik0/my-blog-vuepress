import{_ as s,c as a,d as e,o as t}from"./app-DDoPRsSr.js";const p={};function i(l,n){return t(),a("div",null,[...n[0]||(n[0]=[e(`<h1 id="vite配置开发-生产环境下的环境变量" tabindex="-1"><a class="header-anchor" href="#vite配置开发-生产环境下的环境变量"><span>Vite配置开发/生产环境下的环境变量</span></a></h1><p>在<code>vite.config.js</code>里面有一个<code>envDir</code>的选项，用来指定 Vite 加载的环境变量的路径，默认值是项目的根目录，可以改为其他值：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">envDir</span><span class="token operator">:</span> <span class="token string">&quot;env&quot;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在<code>envDir</code>的目录下新建三个文件：<code>.env</code>、<code>.env.development</code>和<code>.env.production</code>。其中<code>.env</code>是任何模式下都会加载的环境变量，<code>.env.development</code>只会在 development 模式下加载，而<code>.env.production</code>只会在 production 模式下加载。development 和 production 是 Vite 预定义的两个模式，你也可以定义自己的模式，比如 test，这样文件名就是<code>.env.test</code>。</p><p>development 是 Vite 在开发模式下的默认模式，而 production 是 Vite build 时的默认模式。也可以用<code>--mode</code>参数来手动设定模式。也就是说：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token comment"># 这两个命令是等价的</span></span>
<span class="line">vite</span>
<span class="line">vite <span class="token parameter variable">--mode</span> development</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 这两个命令是等价的</span></span>
<span class="line">vite build</span>
<span class="line">vite build <span class="token parameter variable">--mode</span> production</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>.env 文件的格式是简单的 key=value 的格式，其中 value 可以加引号，也可以不加，比如：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">key1=value1</span>
<span class="line">key2=&quot;value2&quot;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>为了防止机密信息泄露，Vite 默认只会导出以<code>VITE_</code>开头的变量。</p><p>要访问环境变量，可以在 JS 中使用<code>import.meta.env.VITE_XXX</code>来访问。需要注意，<code>import.meta</code>只能在 JS Module 的环境中使用，因此不能直接在 Vue 的 template 中访问，需要在 script 部分中先加载才行：</p><div class="language-vue line-numbers-mode" data-highlighter="prismjs" data-ext="vue"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"></span>
<span class="line"><span class="token keyword">const</span> <span class="token constant">XXX</span> <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_XXX</span><span class="token punctuation">;</span></span>
<span class="line"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{ XXX }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,11)])])}const o=s(p,[["render",i]]),d=JSON.parse('{"path":"/posts/vite-env-var.html","title":"Vite配置开发/生产环境下的环境变量","lang":"zh-CN","frontmatter":{"date":"2024-09-20T00:00:00.000Z"},"headers":[],"git":{"updatedTime":1763698804000,"contributors":[{"name":"shi0rik0","username":"shi0rik0","email":"anguuan@outlook.com","commits":1,"url":"https://github.com/shi0rik0"}],"changelog":[{"hash":"27621ea60c6645dc9e44007e7ab6fd2858c37eaf","time":1763698804000,"email":"anguuan@outlook.com","author":"shi0rik0","message":"Migrate posts"}]},"filePathRelative":"posts/vite-env-var.md","excerpt":"\\n<p>在<code>vite.config.js</code>里面有一个<code>envDir</code>的选项，用来指定 Vite 加载的环境变量的路径，默认值是项目的根目录，可以改为其他值：</p>\\n<div class=\\"language-javascript line-numbers-mode\\" data-highlighter=\\"prismjs\\" data-ext=\\"js\\"><pre><code><span class=\\"line\\"><span class=\\"token keyword\\">export</span> <span class=\\"token keyword\\">default</span> <span class=\\"token function\\">defineConfig</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">{</span></span>\\n<span class=\\"line\\">  <span class=\\"token literal-property property\\">envDir</span><span class=\\"token operator\\">:</span> <span class=\\"token string\\">\\"env\\"</span><span class=\\"token punctuation\\">,</span></span>\\n<span class=\\"line\\"><span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span></span>\\n<span class=\\"line\\"></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>"}');export{o as comp,d as data};
