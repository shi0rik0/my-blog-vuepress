import{_ as s,c as a,d as e,o as p}from"./app-D9VVartN.js";const t={};function l(o,n){return p(),a("div",null,[...n[0]||(n[0]=[e(`<h1 id="leetcode题解-lru缓存" tabindex="-1"><a class="header-anchor" href="#leetcode题解-lru缓存"><span>LeetCode题解：LRU缓存</span></a></h1><p>原题网址：https://leetcode.com/problems/lru-cache/description/</p><h2 id="实现思路" tabindex="-1"><a class="header-anchor" href="#实现思路"><span>实现思路</span></a></h2><p>很显然，一个LRU缓存需要支持以下操作：</p><ol><li>将尾部的元素删除。（即淘汰最久未使用的元素）</li><li>将其中一个元素移动到头部。（即将最近使用的元素标记为最新）</li><li>将一个新元素插入到头部。</li><li>给定key，查询对应的元素位置。</li></ol><p>双向链表能够高效地实现操作1-3，而hash表能够高效地实现操作4，所以我们考虑同时使用双向链表和hash表来实现LRU缓存。</p><h2 id="参考代码" tabindex="-1"><a class="header-anchor" href="#参考代码"><span>参考代码</span></a></h2><p>下面的代码是在我的答案基础上，经过LLM优化后的版本。总的来说实现并不难，但是双向链表的操作有很多corner case需要小心处理。实现时可以用虚拟头节点和虚拟尾节点这个常用的技巧来简化链表操作。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">,</span> next_node<span class="token punctuation">,</span> prev_node<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>key <span class="token operator">=</span> key</span>
<span class="line">        self<span class="token punctuation">.</span>val <span class="token operator">=</span> val</span>
<span class="line">        self<span class="token punctuation">.</span><span class="token builtin">next</span> <span class="token operator">=</span> next_node</span>
<span class="line">        self<span class="token punctuation">.</span>prev <span class="token operator">=</span> prev_node</span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">LRUCache</span><span class="token punctuation">:</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> capacity<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>cap <span class="token operator">=</span> capacity</span>
<span class="line">        <span class="token comment"># 使用虚拟头节点和虚拟尾节点可以简化链表操作</span></span>
<span class="line">        <span class="token comment"># self.head -&gt; MRU -&gt; ... -&gt; LRU -&gt; self.tail</span></span>
<span class="line">        self<span class="token punctuation">.</span>head <span class="token operator">=</span> Node<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token comment"># 虚拟头节点</span></span>
<span class="line">        self<span class="token punctuation">.</span>tail <span class="token operator">=</span> Node<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token comment"># 虚拟尾节点</span></span>
<span class="line">        self<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token builtin">next</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>tail</span>
<span class="line">        self<span class="token punctuation">.</span>tail<span class="token punctuation">.</span>prev <span class="token operator">=</span> self<span class="token punctuation">.</span>head</span>
<span class="line"></span>
<span class="line">        self<span class="token punctuation">.</span><span class="token builtin">dict</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment"># 存储 key -&gt; Node 映射</span></span>
<span class="line">        self<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment"># 记录当前缓存中的元素数量</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># 辅助函数：将节点移动到链表头部（虚拟头节点之后）</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">_move_to_front</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> node<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># 1. 从当前位置移除节点</span></span>
<span class="line">        node<span class="token punctuation">.</span>prev<span class="token punctuation">.</span><span class="token builtin">next</span> <span class="token operator">=</span> node<span class="token punctuation">.</span><span class="token builtin">next</span></span>
<span class="line">        node<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">.</span>prev <span class="token operator">=</span> node<span class="token punctuation">.</span>prev</span>
<span class="line"></span>
<span class="line">        <span class="token comment"># 2. 将节点插入到头部（在self.head和self.head.next之间）</span></span>
<span class="line">        node<span class="token punctuation">.</span><span class="token builtin">next</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token builtin">next</span></span>
<span class="line">        node<span class="token punctuation">.</span>prev <span class="token operator">=</span> self<span class="token punctuation">.</span>head</span>
<span class="line">        self<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">.</span>prev <span class="token operator">=</span> node</span>
<span class="line">        self<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token builtin">next</span> <span class="token operator">=</span> node</span>
<span class="line"></span>
<span class="line">    <span class="token comment"># 辅助函数：从链表尾部移除节点（虚拟尾节点之前）</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">_remove_tail</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># 要移除的节点是 self.tail.prev</span></span>
<span class="line">        node_to_remove <span class="token operator">=</span> self<span class="token punctuation">.</span>tail<span class="token punctuation">.</span>prev</span>
<span class="line"></span>
<span class="line">        <span class="token comment"># 从字典中删除</span></span>
<span class="line">        <span class="token keyword">del</span> self<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">[</span>node_to_remove<span class="token punctuation">.</span>key<span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment"># 从链表中移除</span></span>
<span class="line">        node_to_remove<span class="token punctuation">.</span>prev<span class="token punctuation">.</span><span class="token builtin">next</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>tail</span>
<span class="line">        self<span class="token punctuation">.</span>tail<span class="token punctuation">.</span>prev <span class="token operator">=</span> node_to_remove<span class="token punctuation">.</span>prev</span>
<span class="line"></span>
<span class="line">        self<span class="token punctuation">.</span>count <span class="token operator">-=</span> <span class="token number">1</span> <span class="token comment"># 移除后减少计数</span></span>
<span class="line">        <span class="token keyword">return</span> node_to_remove<span class="token punctuation">.</span>key <span class="token comment"># 返回被移除节点的key</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">int</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">if</span> key <span class="token keyword">in</span> self<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">:</span></span>
<span class="line">            node <span class="token operator">=</span> self<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span></span>
<span class="line">            self<span class="token punctuation">.</span>_move_to_front<span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token comment"># 访问后移动到头部</span></span>
<span class="line">            <span class="token keyword">return</span> node<span class="token punctuation">.</span>val</span>
<span class="line">        <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">if</span> key <span class="token keyword">in</span> self<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">:</span></span>
<span class="line">            node <span class="token operator">=</span> self<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span></span>
<span class="line">            node<span class="token punctuation">.</span>val <span class="token operator">=</span> value <span class="token comment"># 更新值</span></span>
<span class="line">            self<span class="token punctuation">.</span>_move_to_front<span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token comment"># 访问后移动到头部</span></span>
<span class="line">            <span class="token keyword">return</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment"># 如果key不存在，创建新节点</span></span>
<span class="line">        new_node <span class="token operator">=</span> Node<span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> new_node</span>
<span class="line">        self<span class="token punctuation">.</span>count <span class="token operator">+=</span> <span class="token number">1</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment"># 如果缓存已满，先淘汰最久未使用的节点</span></span>
<span class="line">        <span class="token keyword">if</span> self<span class="token punctuation">.</span>count <span class="token operator">&gt;</span> self<span class="token punctuation">.</span>cap<span class="token punctuation">:</span></span>
<span class="line">            self<span class="token punctuation">.</span>_remove_tail<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 移除尾部节点</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment"># 将新节点插入到头部</span></span>
<span class="line">        self<span class="token punctuation">.</span>_move_to_front<span class="token punctuation">(</span>new_node<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,9)])])}const i=s(t,[["render",l]]),u=JSON.parse('{"path":"/posts/2025/05/leetcode-lru-cache.html","title":"LeetCode题解：LRU缓存","lang":"zh-CN","frontmatter":{"date":"2025-05-29T00:00:00.000Z","tag":["算法八股文"]},"headers":[{"level":2,"title":"实现思路","slug":"实现思路","link":"#实现思路","children":[]},{"level":2,"title":"参考代码","slug":"参考代码","link":"#参考代码","children":[]}],"git":{"updatedTime":1763699399000,"contributors":[{"name":"shi0rik0","username":"shi0rik0","email":"anguuan@outlook.com","commits":2,"url":"https://github.com/shi0rik0"}],"changelog":[{"hash":"35d50711ef3a591a2383977aa02873c707aa5c1e","time":1763699399000,"email":"anguuan@outlook.com","author":"shi0rik0","message":"Organize files by date"},{"hash":"27621ea60c6645dc9e44007e7ab6fd2858c37eaf","time":1763698804000,"email":"anguuan@outlook.com","author":"shi0rik0","message":"Migrate posts"}]},"filePathRelative":"posts/2025/05/leetcode-lru-cache.md","excerpt":"\\n<p>原题网址：https://leetcode.com/problems/lru-cache/description/</p>\\n<h2>实现思路</h2>\\n<p>很显然，一个LRU缓存需要支持以下操作：</p>\\n<ol>\\n<li>将尾部的元素删除。（即淘汰最久未使用的元素）</li>\\n<li>将其中一个元素移动到头部。（即将最近使用的元素标记为最新）</li>\\n<li>将一个新元素插入到头部。</li>\\n<li>给定key，查询对应的元素位置。</li>\\n</ol>\\n<p>双向链表能够高效地实现操作1-3，而hash表能够高效地实现操作4，所以我们考虑同时使用双向链表和hash表来实现LRU缓存。</p>"}');export{i as comp,u as data};
