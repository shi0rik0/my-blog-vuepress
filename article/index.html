<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.20" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>Articles | shi0rik0 的博客</title><meta name="description" content="shi0rik0 的博客">
    <link rel="preload" href="/assets/style-QXEKf4Y2.css" as="style"><link rel="stylesheet" href="/assets/style-QXEKf4Y2.css">
    <link rel="modulepreload" href="/assets/app-DEX1Ewll.js"><link rel="modulepreload" href="/assets/index.html-BE19esCV.js">
    <link rel="prefetch" href="/assets/index.html-BGYQEEbD.js" as="script"><link rel="prefetch" href="/assets/get-started.html-Bdh9_l1u.js" as="script"><link rel="prefetch" href="/assets/makefile-multiple-outputs.html-D7iDsNub.js" as="script"><link rel="prefetch" href="/assets/powershell-policy.html-BYGBNaQZ.js" as="script"><link rel="prefetch" href="/assets/screen-background-process.html-DIC1D01x.js" as="script"><link rel="prefetch" href="/assets/ssh-http-proxy-windows.html-BcW9xbG3.js" as="script"><link rel="prefetch" href="/assets/from-future-import-annotations.html-CVgQaB14.js" as="script"><link rel="prefetch" href="/assets/generate-iso-8601.html-ClKgRrpt.js" as="script"><link rel="prefetch" href="/assets/latex-algorithm-packages.html-B_7fp99B.js" as="script"><link rel="prefetch" href="/assets/manage-add-remove-programs.html-boF3lSie.js" as="script"><link rel="prefetch" href="/assets/python-loop-else-clause.html-Ctz-Z6iI.js" as="script"><link rel="prefetch" href="/assets/shebang-usr-bin-env.html-reNQUOU_.js" as="script"><link rel="prefetch" href="/assets/useful-software.html-BkO8DzuZ.js" as="script"><link rel="prefetch" href="/assets/uwp-localhost.html-DbJbgf65.js" as="script"><link rel="prefetch" href="/assets/japan-services.html-B0EFC-FR.js" as="script"><link rel="prefetch" href="/assets/pydantic-field-alias.html-Bb1MdM8D.js" as="script"><link rel="prefetch" href="/assets/pyspark-docker-env.html-CiLIcYux.js" as="script"><link rel="prefetch" href="/assets/python-3-12-distutils.html-C4sBD4La.js" as="script"><link rel="prefetch" href="/assets/python-formatters.html-BAGlK5f3.js" as="script"><link rel="prefetch" href="/assets/python-key-parameter.html-EzcYL8vM.js" as="script"><link rel="prefetch" href="/assets/python-stdlib-http-server.html-rHpTD1xs.js" as="script"><link rel="prefetch" href="/assets/torrent-file-vs-magnet-url.html-BLwyhCfC.js" as="script"><link rel="prefetch" href="/assets/ubuntu-common-packages.html-xJwPnwLL.js" as="script"><link rel="prefetch" href="/assets/association-algorithm.html-CerIi4NG.js" as="script"><link rel="prefetch" href="/assets/data-warehouse-problem.html-Cxb2XStl.js" as="script"><link rel="prefetch" href="/assets/decision-tree-id3-c45-cart.html-CqBfesWH.js" as="script"><link rel="prefetch" href="/assets/disable-bitlocker.html-Bklt39_A.js" as="script"><link rel="prefetch" href="/assets/pixel-volte-in-china.html-BpDSUyA7.js" as="script"><link rel="prefetch" href="/assets/python-unzip-encoding.html-CE8KaTeR.js" as="script"><link rel="prefetch" href="/assets/vscode-debugging-config.html-1kCsipNK.js" as="script"><link rel="prefetch" href="/assets/docker-current-dir.html-BqPp0VZI.js" as="script"><link rel="prefetch" href="/assets/dockerignore-trap.html-B_FLEi6l.js" as="script"><link rel="prefetch" href="/assets/extract-pdf-images.html-ImaNoE-3.js" as="script"><link rel="prefetch" href="/assets/modern-html-template.html-DNlOL3OS.js" as="script"><link rel="prefetch" href="/assets/nginx-tutorial.html-DU_juPOt.js" as="script"><link rel="prefetch" href="/assets/service-systemctl.html-2QqBgei6.js" as="script"><link rel="prefetch" href="/assets/vite-env-var.html-DKlwf5rq.js" as="script"><link rel="prefetch" href="/assets/attention-layer.html-CVoAE3rB.js" as="script"><link rel="prefetch" href="/assets/csrf-attack.html-CNJkRRj4.js" as="script"><link rel="prefetch" href="/assets/docker-compose-build.html-jnI24tDU.js" as="script"><link rel="prefetch" href="/assets/docker-healthcheck.html-B9yT9xcG.js" as="script"><link rel="prefetch" href="/assets/docker-windows-slash-bug.html-D0kbdMqb.js" as="script"><link rel="prefetch" href="/assets/dockerfile-cmd-vs-entrypoint.html-CGFA1WOW.js" as="script"><link rel="prefetch" href="/assets/set-up-docker-hub-mirror.html-EylM7N4y.js" as="script"><link rel="prefetch" href="/assets/boto3-type-hints.html-DqFALv3L.js" as="script"><link rel="prefetch" href="/assets/django-on-delete.html-DigjTyEt.js" as="script"><link rel="prefetch" href="/assets/eslint-prettier-for-vue-vscode.html-hJKC-WW0.js" as="script"><link rel="prefetch" href="/assets/functools-wraps.html-DQbohJTW.js" as="script"><link rel="prefetch" href="/assets/npm-install-save-dev.html-DdA7Ox8L.js" as="script"><link rel="prefetch" href="/assets/ssh-copy-id.html-34Pg4wkU.js" as="script"><link rel="prefetch" href="/assets/ubuntu-install-pgsql.html-BPHClr-K.js" as="script"><link rel="prefetch" href="/assets/windows-python-utf8.html-Dzlk2MJh.js" as="script"><link rel="prefetch" href="/assets/c-compiler-warnings.html-CxYz7Zuy.js" as="script"><link rel="prefetch" href="/assets/clangd-config.html-CegKKoas.js" as="script"><link rel="prefetch" href="/assets/pybind11-numpy.html-BhMnDUki.js" as="script"><link rel="prefetch" href="/assets/python-design-patterns.html-DSk3tc5r.js" as="script"><link rel="prefetch" href="/assets/script-rel-path.html-DkXoWY8s.js" as="script"><link rel="prefetch" href="/assets/setuptools-setup-options.html-lFGOZqZO.js" as="script"><link rel="prefetch" href="/assets/sudo-s.html-BQ4obyKN.js" as="script"><link rel="prefetch" href="/assets/sudo-secure-path.html-BMUc-Wv3.js" as="script"><link rel="prefetch" href="/assets/vite-tailwind-css.html-B64u2bOm.js" as="script"><link rel="prefetch" href="/assets/windows-ntp.html-DazN6uLC.js" as="script"><link rel="prefetch" href="/assets/acgn-info.html-DwxaVFaw.js" as="script"><link rel="prefetch" href="/assets/flex-ratio.html-CBBoGpmK.js" as="script"><link rel="prefetch" href="/assets/git-untrack.html-Cw7AM6IV.js" as="script"><link rel="prefetch" href="/assets/pinia-tutorial.html-BNxUuT5Q.js" as="script"><link rel="prefetch" href="/assets/powershell-double-hyphen.html-lYvDKhbr.js" as="script"><link rel="prefetch" href="/assets/proxy-config.html-13cQoBFt.js" as="script"><link rel="prefetch" href="/assets/python-abstract-class.html-CDwmNzTo.js" as="script"><link rel="prefetch" href="/assets/python-implicit-str-concat.html-D8hId0RC.js" as="script"><link rel="prefetch" href="/assets/python-packaging.html-GeWI8Ohi.js" as="script"><link rel="prefetch" href="/assets/setuptools-package-data.html-BM9hLq8G.js" as="script"><link rel="prefetch" href="/assets/windows-program-files.html-BlkMYMWC.js" as="script"><link rel="prefetch" href="/assets/electron-ipc.html-BAIhWg_s.js" as="script"><link rel="prefetch" href="/assets/electron-read-images.html-Be-J0-zF.js" as="script"><link rel="prefetch" href="/assets/leveraged-etf-trap.html-CZ9V4BfI.js" as="script"><link rel="prefetch" href="/assets/pytorch-amp.html-BHpIOuFR.js" as="script"><link rel="prefetch" href="/assets/transformer-inference-mask.html-Z69rFqrB.js" as="script"><link rel="prefetch" href="/assets/disable-iommu.html-DxPYrK0N.js" as="script"><link rel="prefetch" href="/assets/favorite-clang-format.html-mEbT2B0N.js" as="script"><link rel="prefetch" href="/assets/first-version.html-CJbXYayA.js" as="script"><link rel="prefetch" href="/assets/get-public-ip.html-BVcD-AIC.js" as="script"><link rel="prefetch" href="/assets/minimal-python-package.html-BDaUMMpY.js" as="script"><link rel="prefetch" href="/assets/npm-upload.html-B5xVunDN.js" as="script"><link rel="prefetch" href="/assets/python-process-pool-async.html-Bt2IZna1.js" as="script"><link rel="prefetch" href="/assets/python-profile.html-DJ6-hVF8.js" as="script"><link rel="prefetch" href="/assets/screen-cheatsheet.html-BP6Yj3Hv.js" as="script"><link rel="prefetch" href="/assets/self-instruct.html-CawM-kVu.js" as="script"><link rel="prefetch" href="/assets/smtp2go.html-4hsYhsrW.js" as="script"><link rel="prefetch" href="/assets/ubuntu-install-redis.html-CK9jE85m.js" as="script"><link rel="prefetch" href="/assets/vscode-cmake-windows.html-DT2dgKjb.js" as="script"><link rel="prefetch" href="/assets/windows-lib-static-or-dynamic.html-C4Dxqqx3.js" as="script"><link rel="prefetch" href="/assets/wsl-network.html-B3rVY4KR.js" as="script"><link rel="prefetch" href="/assets/gc-comparison.html-CT3vf3M-.js" as="script"><link rel="prefetch" href="/assets/hydra-tutorial.html-DKlrA2kM.js" as="script"><link rel="prefetch" href="/assets/pytorch-batch-trick.html-BtBQpGzl.js" as="script"><link rel="prefetch" href="/assets/a-star-decrease-key.html-oqERLjp8.js" as="script"><link rel="prefetch" href="/assets/get-card-issuer.html-Cq2IB4Jl.js" as="script"><link rel="prefetch" href="/assets/install-unity-hub-ubuntu.html-C6HxwfPP.js" as="script"><link rel="prefetch" href="/assets/leetcode-linked-list-cycle.html-BPbN2bnb.js" as="script"><link rel="prefetch" href="/assets/leetcode-lru-cache.html-DxSPev-o.js" as="script"><link rel="prefetch" href="/assets/leetcode-shortest-supersequence.html-rGJ70QJ4.js" as="script"><link rel="prefetch" href="/assets/matplotlib-chinese-font.html-Dz0OzlQ6.js" as="script"><link rel="prefetch" href="/assets/python-asyncio-future.html-DrU7tstS.js" as="script"><link rel="prefetch" href="/assets/python-implement-coroutine.html-CrNugzQ-.js" as="script"><link rel="prefetch" href="/assets/python-subclasshook.html-BpXQLjsV.js" as="script"><link rel="prefetch" href="/assets/leetcode-find-longest-subarray.html-rvwSezDT.js" as="script"><link rel="prefetch" href="/assets/leetcode-get-kth-magic-number.html-lYfoKfG8.js" as="script"><link rel="prefetch" href="/assets/leetcode-multi-search.html-DpA0YhdZ.js" as="script"><link rel="prefetch" href="/assets/leetcode-rank-from-stream.html-BMNtpKn2.js" as="script"><link rel="prefetch" href="/assets/python-negative-bit-op.html-DzWbclbi.js" as="script"><link rel="prefetch" href="/assets/qwen-video-timestamp.html-DdcrayRk.js" as="script"><link rel="prefetch" href="/assets/virtualbox-network.html-BpDnT_Hm.js" as="script"><link rel="prefetch" href="/assets/priming-and-erp.html-DuBnalS-.js" as="script"><link rel="prefetch" href="/assets/taiwanese-songs-1932-1939.html-sOem6LC7.js" as="script"><link rel="prefetch" href="/assets/dns-settings.html-BXONf1c6.js" as="script"><link rel="prefetch" href="/assets/github-pages-tutorial.html-BF0fpp_I.js" as="script"><link rel="prefetch" href="/assets/python-deprecated-decorator.html-BOR_nA7r.js" as="script"><link rel="prefetch" href="/assets/404.html-D9s_06hk.js" as="script"><link rel="prefetch" href="/assets/index.html-Df7oNFuB.js" as="script"><link rel="prefetch" href="/assets/index.html-DKH2Gwfg.js" as="script"><link rel="prefetch" href="/assets/index.html-9voOX8KT.js" as="script"><link rel="prefetch" href="/assets/index.html-CM62zu4I.js" as="script"><link rel="prefetch" href="/assets/index.html-daIEPCYH.js" as="script"><link rel="prefetch" href="/assets/index.html-DGGgFgqN.js" as="script"><link rel="prefetch" href="/assets/index.html-Du-UOnLU.js" as="script"><link rel="prefetch" href="/assets/index.html-Gfs1nyin.js" as="script"><link rel="prefetch" href="/assets/index.html-B9JpUKA1.js" as="script"><link rel="prefetch" href="/assets/index.html-CxVvS6M7.js" as="script"><link rel="prefetch" href="/assets/index.html-CccbjF2e.js" as="script"><link rel="prefetch" href="/assets/index.html-BFMy1b-S.js" as="script"><link rel="prefetch" href="/assets/index.html-CuLqRbnR.js" as="script"><link rel="prefetch" href="/assets/index.html-C77rCP_c.js" as="script"><link rel="prefetch" href="/assets/index.html-V6rTfLsu.js" as="script"><link rel="prefetch" href="/assets/index.html-DLMH2sSc.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container no-sidebar external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="https://vuejs.press/images/hero.png" alt="shi0rik0 的博客"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">shi0rik0 的博客</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><!--[--><!--]--><!--]-->Home<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/article/" aria-label="Article"><!--[--><!--[--><!--]--><!--]-->Article<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/category/" aria-label="Category"><!--[--><!--[--><!--]--><!--]-->Category<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/tag/" aria-label="Tag"><!--[--><!--[--><!--]--><!--]-->Tag<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/timeline/" aria-label="Timeline"><!--[--><!--[--><!--]--><!--]-->Timeline<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><!--[--><!--]--><!--]-->Home<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/article/" aria-label="Article"><!--[--><!--[--><!--]--><!--]-->Article<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/category/" aria-label="Category"><!--[--><!--[--><!--]--><!--]-->Category<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/tag/" aria-label="Tag"><!--[--><!--[--><!--]--><!--]-->Tag<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/timeline/" aria-label="Timeline"><!--[--><!--[--><!--]--><!--]-->Timeline<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><!----><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><div class="article-wrapper"><!----><!--[--><article class="article"><header class="title">关于 Qwen 视频时间戳不准确的问题</header><hr><div class="article-info"><!----><span class="date">Date: 11/21/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近做的一个项目需要用大模型来分析视频，在实验过程中发现，Qwen3-omni 系列的模型生成的视频时间戳并不准确。比如说，我问模型某个视频的时长是多少秒，结果模型无法给出正确答案。更复杂的问题就更加答不对了。</p>
<p>经过测试，以下模型均存在该问题：</p>
<ul>
<li>Qwen3-omni（开源版）</li>
<li>Qwen2.5-VL</li>
<li>Qwen2.5-omni</li>
</ul>
<p>而以下模型则不存在该问题：</p>
<ul>
<li>Qwen3-VL</li>
<li>Qwen3-omni-flash（闭源）</li>
</ul>
<p>我目前认为，Qwen3-VL 之所以能够得到正确的时间戳，是因为它的输入序列中有绝对时间信息的 token，而 Qwen3-omni 则没有。尽管 Qwen3-omni 采用的 M-RoPE 编码能够让模型明白视频帧的时间相对顺序，但是模型无法得知绝对时间。</p></div></article><article class="article"><header class="title">LeetCode题解：数字流的秩</header><hr><div class="article-info"><!----><span class="date">Date: 6/6/2025</span><span class="category">Category: </span><span class="tag">Tag: 算法八股文, 树状数组</span></div><div class="excerpt">
<p>题目链接：https://leetcode.cn/problems/rank-from-stream-lcci/</p>
<h2>解题思路</h2>
<p>这道题目的官方提示是使用一个携带额外信息的二叉搜索树来解决问题，用二叉搜索树的优点是对于输入数据的范围没有限制，但是缺点在于：如果使用朴素的二叉搜索树，最坏时间复杂度会很差，而平衡二叉搜索树的实现会比较复杂。考虑到题目中<code>x</code>的范围是<code>[0, 5e4]</code>，我们也可以使用树状数组来解决问题。</p>
<h2>树状数组</h2>
<p>树状数组（Binary Indexed Tree），也叫Fenwick Tree，是一种数据结构，可以用来高效地维护一个固定长度数组（设长度为<code>N</code>）的区间和。它支持两种操作：</p></div></article><article class="article"><header class="title">关于Python中负数的位运算</header><hr><div class="article-info"><!----><span class="date">Date: 6/5/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>引言</h2>
<p>最近做了一道<a href="https://leetcode.cn/problems/convert-integer-lcci/" target="_blank" rel="noopener noreferrer">LeetCode题目</a>，题目本身不难，只需要将两个整数进行按位XOR操作，然后计算结果的二进制表示中1的个数即可。下面是我最初的实现：</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">a <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">b <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">c <span class="token operator">=</span> a <span class="token operator">^</span> b</span>
<span class="line">n <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line"><span class="token keyword">while</span> c<span class="token punctuation">:</span></span>
<span class="line">    n <span class="token operator">+=</span> c <span class="token operator">&amp;</span> <span class="token number">1</span></span>
<span class="line">    c <span class="token operator">&gt;&gt;</span><span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">LeetCode题解：第k个数</header><hr><div class="article-info"><!----><span class="date">Date: 6/4/2025</span><span class="category">Category: </span><span class="tag">Tag: 算法八股文</span></div><div class="excerpt">
<p>题目链接：https://leetcode.cn/problems/get-kth-magic-number-lcci/</p>
<h2>解题思路</h2>
<p>这道题有时间复杂度为O(k)的解法，但是这里介绍一个更通用且更容易理解的算法，其时间复杂度为O(k log k)。</p>
<p>给出集合${f(a, b, c) | a, b, c \in \mathbb{N}^+}$，其中$f(a, b, c) = 3^a \cdot 5^b \cdot 7^c$。我们需要找到这个集合中的第k个最小值。注意到$f(a, b, c)$是单调递增的，也就是说如果$a_1 \leq a_2$，$b_1 \leq b_2$，$c_1 \leq c_2$，那么$f(a_1, b_1, c_1) \leq f(a_2, b_2, c_2)$。因此，假如我们把这个问题看作一个按照大小顺序进行搜索的问题，那么下一个要搜索的(a, b, c)一定会和已搜索过的(a, b, c)相邻，所以我们只需要用一个优先队列来存储已搜索过的(a, b, c)的邻居，从中获取下一个要搜索的(a, b, c)即可。我们还需要一个哈希表来记录已搜索过的(a, b, c)，以避免重复搜索。</p></div></article><article class="article"><header class="title">LeetCode题解：字母与数字</header><hr><div class="article-info"><!----><span class="date">Date: 6/3/2025</span><span class="category">Category: </span><span class="tag">Tag: 算法八股文, 前缀和</span></div><div class="excerpt">
<p>题目链接：https://leetcode.cn/problems/find-longest-subarray-lcci/</p>
<h2>解题思路</h2>
<p>这道题可以转化为一个经典的问题：在一个数组中找到和为k的最长子数组。我们只要将数组中的字母替换成1，数字替换成-1，那么原题就变成了在一个数组中找到和为0的最长子数组。</p>
<p>要解决这个问题，我们需要用到一个叫做“前缀和”的技巧。我们用<code>sum(i, j)</code>表示数组在区间<code>[i, j)</code>上的和（<code>sum(i, i) = 0</code>），如果令数组<code>prefix[i] = sum(0, i)</code>，那么就可以快速计算出<code>sum(i, j) = prefix[j] - prefix[i]</code>。</p></div></article><article class="article"><header class="title">LeetCode题解：多次搜索</header><hr><div class="article-info"><!----><span class="date">Date: 6/2/2025</span><span class="category">Category: </span><span class="tag">Tag: 算法八股文, 前缀树</span></div><div class="excerpt">
<p>题目网址：https://leetcode.cn/problems/multi-search-lcci/</p>
<h2>解题思路</h2>
<p>这题是前缀树（也叫字典树、Trie）的一个典型应用。我们可以将所有需要查询的单词插入到前缀树中，然后对字符串的每个字符进行遍历，查找以该字符为起点的所有单词。</p>
<h2>参考实现</h2>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> idx<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> children<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>idx <span class="token operator">=</span> idx</span>
<span class="line">        self<span class="token punctuation">.</span>children <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">if</span> children <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">else</span> children</span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">multiSearch</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> big<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> smalls<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># 构建前缀树</span></span>
<span class="line">        root <span class="token operator">=</span> Node<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">for</span> i<span class="token punctuation">,</span> s <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>smalls<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            node <span class="token operator">=</span> root</span>
<span class="line">            <span class="token keyword">for</span> j<span class="token punctuation">,</span> ch <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword">if</span> ch <span class="token keyword">not</span> <span class="token keyword">in</span> node<span class="token punctuation">.</span>children<span class="token punctuation">:</span></span>
<span class="line">                    node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>ch<span class="token punctuation">]</span> <span class="token operator">=</span> Node<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                node <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>ch<span class="token punctuation">]</span></span>
<span class="line">                <span class="token keyword">if</span> j <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span></span>
<span class="line">                    node<span class="token punctuation">.</span>idx <span class="token operator">=</span> i</span>
<span class="line"></span>
<span class="line">        <span class="token comment"># 遍历大字符串，查找所有小字符串</span></span>
<span class="line">        ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>smalls<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>big<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            node <span class="token operator">=</span> root</span>
<span class="line">            j <span class="token operator">=</span> i</span>
<span class="line">            <span class="token keyword">while</span> j <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>big<span class="token punctuation">)</span> <span class="token keyword">and</span> big<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token keyword">in</span> node<span class="token punctuation">.</span>children<span class="token punctuation">:</span></span>
<span class="line">                node <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>big<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span></span>
<span class="line">                j <span class="token operator">+=</span> <span class="token number">1</span></span>
<span class="line">                <span class="token keyword">if</span> node<span class="token punctuation">.</span>idx <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span></span>
<span class="line">                    ans<span class="token punctuation">[</span>node<span class="token punctuation">.</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span> ans</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">LeetCode题解：环路检测</header><hr><div class="article-info"><!----><span class="date">Date: 5/30/2025</span><span class="category">Category: </span><span class="tag">Tag: 算法八股文</span></div><div class="excerpt">
<p>原题网址：https://leetcode.cn/problems/linked-list-cycle-lcci/</p>
<h2>解题思路</h2>
<p>这道题目就是经典的<a href="https://en.wikipedia.org/wiki/Cycle_detection#Floyd's_tortoise_and_hare" target="_blank" rel="noopener noreferrer">Floyd龟兔赛跑算法</a>。这个算法主要分为两个部分，第一个部分就是如何判定是否有环，第二个部分就是如何找到环的起点。第一个部分比较简单，很容易理解，因此也很脍炙人口。但是第二个部分就比较少人知道了，因为其推导过程相对复杂一些，具体可以参考<a href="https://leetcode.cn/problems/linked-list-cycle-lcci/solutions/531787/huan-lu-jian-ce-by-leetcode-solution-s2la/" target="_blank" rel="noopener noreferrer">LeetCode官方的题解</a>。</p></div></article><article class="article"><header class="title">LeetCode题解：最短超串</header><hr><div class="article-info"><!----><span class="date">Date: 5/30/2025</span><span class="category">Category: </span><span class="tag">Tag: 算法八股文, 滑动窗口</span></div><div class="excerpt">
<p>题目链接：https://leetcode.cn/problems/shortest-supersequence-lcci/</p>
<h2>解题思路</h2>
<p>这个题目属于一类很典型的问题：给定一个数组，要找到满足某个性质的<strong>最短子数组</strong>。这类问题往往可以用滑动窗口的方式来解决。</p>
<p>下面是滑动窗口的模板代码：</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">arr <span class="token operator">=</span> get_input_arr<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">status <span class="token operator">=</span> init_status<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">left <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">right <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">min_len <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">'inf'</span><span class="token punctuation">)</span></span>
<span class="line">ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">if</span> right <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token keyword">not</span> is_condition_met<span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        right <span class="token operator">+=</span> <span class="token number">1</span></span>
<span class="line">        status<span class="token punctuation">.</span>update<span class="token punctuation">(</span>left<span class="token punctuation">,</span> right<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">if</span> left <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">break</span></span>
<span class="line">        <span class="token comment"># 如果有多个相同长度的最短子数组，会保留左侧索引最小的</span></span>
<span class="line">        <span class="token keyword">if</span> is_condition_met<span class="token punctuation">(</span>status<span class="token punctuation">)</span> <span class="token keyword">and</span> right <span class="token operator">-</span> left <span class="token operator">&lt;</span> min_len<span class="token punctuation">:</span></span>
<span class="line">            min_len <span class="token operator">=</span> right <span class="token operator">-</span> left</span>
<span class="line">            ans <span class="token operator">=</span> <span class="token punctuation">[</span>left<span class="token punctuation">,</span> right <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">        left <span class="token operator">+=</span> <span class="token number">1</span></span>
<span class="line">        status<span class="token punctuation">.</span>update<span class="token punctuation">(</span>left<span class="token punctuation">,</span> right<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">return</span> ans</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">解决Matplotlib中文乱码问题</header><hr><div class="article-info"><!----><span class="date">Date: 5/30/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>Python的Matplotlib库默认是无法显示中文的，因为Matplotlib默认使用的字体不支持中文字符。为了在Matplotlib中显示中文，我们需要手动配置字体。</p>
<p>首先可以用以下代码查看当前系统可用的字体</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>font_manager <span class="token keyword">as</span> fm</span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>fm<span class="token punctuation">.</span>get_font_names<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">关于A*算法：我们真的需要Decrease-Key操作吗？</header><hr><div class="article-info"><!----><span class="date">Date: 5/29/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>我们知道，A*算法的伪代码如下：</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">start_point <span class="token operator">=</span> Point<span class="token punctuation">(</span>pos<span class="token operator">=</span>start_pos<span class="token punctuation">,</span> g<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> h<span class="token operator">=</span>heuristic<span class="token punctuation">(</span>start_pos<span class="token punctuation">,</span> end_pos<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">open_list <span class="token operator">=</span> <span class="token punctuation">{</span>start_point<span class="token punctuation">}</span></span>
<span class="line">closed_list <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">while</span> <span class="token keyword">not</span> open_list<span class="token punctuation">.</span>is_empty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># 从open_list中取出f值最小的点</span></span>
<span class="line">    current <span class="token operator">=</span> open_list<span class="token punctuation">.</span>pop_point_with_lowest_f<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 如果当前点是目标点，说明找到最短路径了</span></span>
<span class="line">    <span class="token keyword">if</span> current <span class="token operator">==</span> end_point<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> reconstruct_path<span class="token punctuation">(</span>current<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 否则，处理当前点的邻居</span></span>
<span class="line">    <span class="token keyword">for</span> neighbor <span class="token keyword">in</span> get_neighbors<span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># 已经在closed_list中的点无需处理</span></span>
<span class="line">        <span class="token keyword">if</span> neighbor <span class="token keyword">in</span> closed_list<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">continue</span></span>
<span class="line">        tentative_g <span class="token operator">=</span> current<span class="token punctuation">.</span>g <span class="token operator">+</span> cost<span class="token punctuation">(</span>current<span class="token punctuation">,</span> neighbor<span class="token punctuation">)</span></span>
<span class="line">        tentative_h <span class="token operator">=</span> heuristic<span class="token punctuation">(</span>neighbor<span class="token punctuation">,</span> end_pos<span class="token punctuation">)</span></span>
<span class="line">        tentative_neighbor <span class="token operator">=</span> Point<span class="token punctuation">(</span>pos<span class="token operator">=</span>neighbor<span class="token punctuation">,</span> g<span class="token operator">=</span>tentative_g<span class="token punctuation">,</span> h<span class="token operator">=</span>tentative_h<span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># 如果邻居点是新发现的点，直接加入open_list</span></span>
<span class="line">        <span class="token keyword">if</span> neighbor <span class="token keyword">not</span> <span class="token keyword">in</span> open_list<span class="token punctuation">:</span></span>
<span class="line">            open_list<span class="token punctuation">.</span>add<span class="token punctuation">(</span>tentative_neighbor<span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># 否则，检查能否更新邻居点的g值</span></span>
<span class="line">        <span class="token keyword">elif</span> tentative_neighbor<span class="token punctuation">.</span>g <span class="token operator">&lt;</span> open_list<span class="token punctuation">.</span>get<span class="token punctuation">(</span>neighbor<span class="token punctuation">)</span><span class="token punctuation">.</span>g<span class="token punctuation">:</span></span>
<span class="line">            open_list<span class="token punctuation">.</span>update<span class="token punctuation">(</span>tentative_neighbor<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 当前点处理完毕，加入closed_list</span></span>
<span class="line">    closed_list<span class="token punctuation">.</span>add<span class="token punctuation">(</span>current<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">LeetCode题解：LRU缓存</header><hr><div class="article-info"><!----><span class="date">Date: 5/29/2025</span><span class="category">Category: </span><span class="tag">Tag: 算法八股文</span></div><div class="excerpt">
<p>原题网址：https://leetcode.com/problems/lru-cache/description/</p>
<h2>实现思路</h2>
<p>很显然，一个LRU缓存需要支持以下操作：</p>
<ol>
<li>将尾部的元素删除。（即淘汰最久未使用的元素）</li>
<li>将其中一个元素移动到头部。（即将最近使用的元素标记为最新）</li>
<li>将一个新元素插入到头部。</li>
<li>给定key，查询对应的元素位置。</li>
</ol>
<p>双向链表能够高效地实现操作1-3，而hash表能够高效地实现操作4，所以我们考虑同时使用双向链表和hash表来实现LRU缓存。</p></div></article><article class="article"><header class="title">在Ubuntu 24.04上安装Unity Hub</header><hr><div class="article-info"><!----><span class="date">Date: 5/21/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近在Ubuntu 24.04上安装Unity Hub的时候遇到了很多问题，下面记录一下解决的过程。</p>
<p>首先在官网上下载Unity Hub的deb包，安装之后就可以通过<code>unityhub</code>命令来启动Unity Hub，但是直接启动会报错，提示为找不到sandbox。</p>
<p>这个问题的解决办法是安装Chrome，然后将sandbox的文件复制过去：</p>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">cp</span> /opt/google/chrome/chrome-sandbox /opt/unityhub</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">chown</span> root:root /opt/unityhub/chrome-sandbox</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">chmod</span> <span class="token number">4755</span> /opt/unityhub/chrome-sandbox</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">用支付宝的未公开API获取银行卡发卡行</header><hr><div class="article-info"><!----><span class="date">Date: 5/20/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近发现GitHub上有个项目（<a href="https://github.com/zhuzhichao/bank-card-info" target="_blank" rel="noopener noreferrer">zhuzhichao/bank-card-info</a>），提供了可以根据银行卡号获取发卡行的API。看了下源码，发现它是通过调用支付宝的一个未公开的API实现的。虽然不知道作者是怎么发现这个API的，不过这个API目前还可以使用，并且不需要任何认证。</p>
<p>下面是一个简单的Python示例代码，展示了如何用这个API来获取发卡行信息：</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> requests</span>
<span class="line"></span>
<span class="line">CARD_NUMBER <span class="token operator">=</span> <span class="token number">6259960000114514</span></span>
<span class="line"></span>
<span class="line">url <span class="token operator">=</span> <span class="token string">"https://ccdcapi.alipay.com/validateAndCacheCardInfo.json"</span></span>
<span class="line">params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"cardNo"</span><span class="token punctuation">:</span> CARD_NUMBER<span class="token punctuation">,</span> <span class="token string">"_input_charset"</span><span class="token punctuation">:</span> <span class="token string">"utf-8"</span><span class="token punctuation">,</span> <span class="token string">"cardBinCheck"</span><span class="token punctuation">:</span> <span class="token string">"true"</span><span class="token punctuation">}</span></span>
<span class="line">response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">card_types <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"CC"</span><span class="token punctuation">:</span> <span class="token string">"信用卡"</span><span class="token punctuation">,</span> <span class="token string">"DC"</span><span class="token punctuation">:</span> <span class="token string">"借记卡"</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"银行卡类型："</span><span class="token punctuation">,</span> card_types<span class="token punctuation">.</span>get<span class="token punctuation">(</span>response<span class="token punctuation">[</span><span class="token string">"cardType"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"未知"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"发卡行编码："</span><span class="token punctuation">,</span> response<span class="token punctuation">[</span><span class="token string">"bank"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">深入Python的asyncio：Future对象</header><hr><div class="article-info"><!----><span class="date">Date: 5/19/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>假设我们有这么一个异步API，它接受一个callback参数，当任务完成时会调用这个callback函数来返回结果：</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> threading</span>
<span class="line"><span class="token keyword">import</span> time</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">async_func</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">thread_func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">        callback<span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    thread <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>thread_func<span class="token punctuation">)</span></span>
<span class="line">    thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">callback</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Callback executed with result: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">async_func<span class="token punctuation">(</span>callback<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Python中的__subclasshook__方法</header><hr><div class="article-info"><!----><span class="date">Date: 5/13/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近在查阅Python标准库<code>collections.abc</code>的源代码时，发现一个有趣的“魔法方法”<code>__subclasshook__</code>。这个方法其实是一个假的魔法方法，因为它并没有任何特殊性。如果一个类继承了<code>abc.ABC</code>，那么对这个类调用<code>issubclass</code>，或者对这个类的对象调用<code>isinstance</code>时，Python就会自动调用这个类的<code>__subclasshook__</code>方法。</p>
<p>举个例子，下面的类<code>Addable</code>用来描述可以进行加法运算的接口。</p></div></article><article class="article"><header class="title">在Python中实现一个简易的协程</header><hr><div class="article-info"><!----><span class="date">Date: 5/12/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>基本概念</h2>
<p>在Python的协程体系中有两个基本概念：coroutine和coroutine function。</p>
<p>coroutine对象拥有一个<code>__await__</code>函数，调用这个函数会返回一个生成器。而调用一个coroutine function则会返回一个coroutine对象。</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> asyncio</span>
<span class="line"><span class="token keyword">from</span> collections<span class="token punctuation">.</span>abc <span class="token keyword">import</span> Generator</span>
<span class="line"></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">pass</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 都会返回 True</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span>iscoroutinefunction<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span>iscoroutine<span class="token punctuation">(</span>f<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>f<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__await__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Generator<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Python配置库Hydra的教程</header><hr><div class="article-info"><!----><span class="date">Date: 4/30/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>Hydra是Meta团队开发的一个Python库，主要是用来管理配置的。虽然我个人比较反感这种框架，因为我觉得配置本身是一个很简单的需求，没必要搞得这么复杂，但是Habitat仿真器的配置就是用Hydra加载的，所以还是不得不稍微了解一下。</p>
<p>Hydra配置文件都是用YAML格式编写的，下面是一个例子：</p>
<p>main.yaml:</p>
<div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code><span class="line"><span class="token key atrule">defaults</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token punctuation">-</span> _self_</span>
<span class="line">  <span class="token punctuation">-</span> <span class="token key atrule">db/engine</span><span class="token punctuation">:</span> mysql</span>
<span class="line">  <span class="token punctuation">-</span> network</span>
<span class="line"></span>
<span class="line"><span class="token key atrule">db</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">engine</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">name</span><span class="token punctuation">:</span> postgresql</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">PyTorch的BatchSampler的一个优化技巧</header><hr><div class="article-info"><!----><span class="date">Date: 4/29/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近在阅读PyTorch的源码的时候，发现<code>torch.utils.data.sampler.BatchSampler</code>的实现非常有意思：</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Iterator<span class="token punctuation">[</span>List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># Implemented based on the benchmarking in https://github.com/pytorch/pytorch/pull/76951</span></span>
<span class="line">        sampler_iter <span class="token operator">=</span> <span class="token builtin">iter</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>sampler<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">if</span> self<span class="token punctuation">.</span>drop_last<span class="token punctuation">:</span></span>
<span class="line">            <span class="token comment"># Create multiple references to the same iterator</span></span>
<span class="line">            args <span class="token operator">=</span> <span class="token punctuation">[</span>sampler_iter<span class="token punctuation">]</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>batch_size</span>
<span class="line">            <span class="token keyword">for</span> batch_droplast <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword">yield</span> <span class="token punctuation">[</span><span class="token operator">*</span>batch_droplast<span class="token punctuation">]</span></span>
<span class="line">        <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">            batch <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">*</span>itertools<span class="token punctuation">.</span>islice<span class="token punctuation">(</span>sampler_iter<span class="token punctuation">,</span> self<span class="token punctuation">.</span>batch_size<span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line">            <span class="token keyword">while</span> batch<span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword">yield</span> batch</span>
<span class="line">                batch <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">*</span>itertools<span class="token punctuation">.</span>islice<span class="token punctuation">(</span>sampler_iter<span class="token punctuation">,</span> self<span class="token punctuation">.</span>batch_size<span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">常见编程语言的GC机制对比</header><hr><div class="article-info"><!----><span class="date">Date: 4/2/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>Java &amp; C#</h2>
<p>Java和C#都采用了“分代”的思想，将对象分为不同的“代”，对于不同的“代”采用不同的GC策略。具体采用的GC策略包括：复制、标记-清除、标记-整理等。这种方式的优点是吞吐量高，缺点则是STW（Stop The World）时间较长。</p>
<h2>Go</h2>
<p>Go使用了三色标记法，这种方式的GC中断次数较多，但是每次的中断时间较短，可以说是一种牺牲吞吐量来换取较低STW时间的GC策略。</p>
<p>参考资料：</p>
<ul>
<li>https://www.zhihu.com/question/326191221</li>
<li>https://medium.com/servicetitan-engineering/go-vs-c-part-2-garbage-collection-9384677f86f1</li>
</ul></div></article><article class="article"><header class="title">推荐一个免费的SMTP送信服务：SMTP2GO</header><hr><div class="article-info"><!----><span class="date">Date: 3/31/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近我想实现这么一个功能：编写一个程序监控股价，当剧烈波动时，就给我发个推送通知。仔细想了想，发现成本最低、实现最简单的推送方法是就是给我的邮箱发个邮件。但很可惜的是，现在主流的邮箱服务商都启用了2FA，因此不能直接通过用户名和密码来发送邮件了。最后我找到了一个名为<a href="https://www.smtp2go.com/" target="_blank" rel="noopener noreferrer">SMTP2GO</a>的服务商，它们提供的SMTP服务可以直接使用用户名和密码来发送邮件。下面是利用Python和SMTP2GO来发送邮件的教程。</p>
<p>首先要注册一个SMTP2GO的账户。注意：SMTP2GO不支持用public domain的邮箱（例如outlook.com等）注册，必须通过企业、学校邮箱之类的注册。</p></div></article><article class="article"><header class="title">我最喜欢的clang-format配置</header><hr><div class="article-info"><!----><span class="date">Date: 3/27/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>我最喜欢的clang-format配置是：</p>
<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">BasedOnStyle: WebKit</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">VS Code + CMake + Windows配置指南</header><hr><div class="article-info"><!----><span class="date">Date: 3/27/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>这篇指南会教你如何在Windows下给VS Code配置一个舒服的CMake开发环境。</p>
<p>首先要安装VS Build Tools，可以在<a href="https://visualstudio.microsoft.com/visual-cpp-build-tools/" target="_blank" rel="noopener noreferrer">VS官网</a>下载。</p>
<p>然后给VS Code安装CMake Tools和clangd扩展。</p>
<p>然后在VS Code的配置文件里加入以下设置：</p>
<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">"cmake.generator": "Ninja"</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">判断Windows的lib文件是静态库还是动态库的方法</header><hr><div class="article-info"><!----><span class="date">Date: 3/27/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>众所周知，在Linux下，动态库的后缀名是.so，而静态库的后缀名则是.a。但是在Windows下，静态库的后缀名是.lib，而动态库则包含两个文件，一个是.dll文件，另一个是.lib文件。下面的表格总结了Linux和Windows的差异：</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>Linux</th>
<th>Windows</th>
</tr>
</thead>
<tbody>
<tr>
<td>静态库</td>
<td>.a</td>
<td>.lib</td>
</tr>
<tr>
<td>动态库</td>
<td>.so</td>
<td>.dll + .lib</td>
</tr>
</tbody>
</table></div></article><article class="article"><header class="title">在Python中用进程池异步执行任务</header><hr><div class="article-info"><!----><span class="date">Date: 3/25/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>废话不多说，先直接上代码：</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> asyncio</span>
<span class="line"><span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ProcessPoolExecutor</span>
<span class="line"><span class="token keyword">import</span> multiprocessing</span>
<span class="line"><span class="token keyword">import</span> os</span>
<span class="line"></span>
<span class="line">var_per_process <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">initialize_process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">global</span> var_per_process</span>
<span class="line">    var_per_process <span class="token operator">=</span> os<span class="token punctuation">.</span>getpid<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Process </span><span class="token interpolation"><span class="token punctuation">{</span>var_per_process<span class="token punctuation">}</span></span><span class="token string"> received </span><span class="token interpolation"><span class="token punctuation">{</span>arg1<span class="token punctuation">}</span></span><span class="token string"> and </span><span class="token interpolation"><span class="token punctuation">{</span>arg2<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> arg1 <span class="token operator">+</span> arg2</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">with</span> ProcessPoolExecutor<span class="token punctuation">(</span></span>
<span class="line">        max_workers<span class="token operator">=</span>multiprocessing<span class="token punctuation">.</span>cpu_count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> initializer<span class="token operator">=</span>initialize_process</span>
<span class="line">    <span class="token punctuation">)</span> <span class="token keyword">as</span> executor<span class="token punctuation">:</span></span>
<span class="line">        inputs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line">        results <span class="token operator">=</span> <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span></span>
<span class="line">            <span class="token operator">*</span><span class="token punctuation">[</span>loop<span class="token punctuation">.</span>run_in_executor<span class="token punctuation">(</span>executor<span class="token punctuation">,</span> add<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">)</span> <span class="token keyword">for</span> i<span class="token punctuation">,</span> j <span class="token keyword">in</span> inputs<span class="token punctuation">]</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span></span>
<span class="line">    asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Self-Instruct: 让LLM自己生成指令微调数据集</header><hr><div class="article-info"><!----><span class="date">Date: 3/24/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近看到一篇比较有意思的论文：<a href="https://arxiv.org/abs/2212.10560" target="_blank" rel="noopener noreferrer">Self-Instruct: Aligning Language Models with Self-Generated Instructions</a>。这篇论文的思路就是让LLM自己生成指令微调数据集，然后用它反过来训练自己。这么做有点左脚踩右脚的感觉。基于这个思路，斯坦福大学的团队训练了一个名为Alpaca的模型，模型的权重、数据集和代码都在GitHub上开源了：<a href="https://github.com/tatsu-lab/stanford_alpaca" target="_blank" rel="noopener noreferrer">tatsu-lab/stanford_alpaca</a>。下面就简单介绍一下这个方法。</p></div></article><article class="article"><header class="title">Python性能分析教程</header><hr><div class="article-info"><!----><span class="date">Date: 3/20/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>Python标准库里面有两个可以用于性能分析的模块：<code>cProfile</code> 和 <code>profile</code>。<code>cProfile</code>是用C编写的，而<code>profile</code>是用纯Python实现的。它们的接口类似，但是并不完全相同，比如说它们的输出文件格式不同。有一个知名的库<code>snakeviz</code>可以用来可视化<code>cProfile</code>的输出文件，但是它不支持<code>profile</code>的输出文件。<code>cProfile</code>不仅更快，还被<code>snakeviz</code>所支持，所以大多数时候还是推荐使用<code>cProfile</code>。</p></div></article><article class="article"><header class="title">Python标记deprecated的装饰器</header><hr><div class="article-info"><!----><span class="date">Date: 3/19/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>从Python 3.13开始，<code>warnings</code>模块里新增了一个<code>@deprecated</code>装饰器，用于标记函数等已经被启用。具体可以参考<a href="https://docs.python.org/3/library/warnings.html#warnings.deprecated" target="_blank" rel="noopener noreferrer">Python文档</a>和<a href="https://peps.python.org/pep-0702/" target="_blank" rel="noopener noreferrer">PEP 702</a>。</p></div></article><article class="article"><header class="title">如何获取公网IP地址</header><hr><div class="article-info"><!----><span class="date">Date: 3/18/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>如果机器的网卡直接可以通过外网访问，那么可以直接通过以下命令获取网卡的IP地址：</p>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">hostname</span> <span class="token parameter variable">-I</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Ubuntu安装Redis</header><hr><div class="article-info"><!----><span class="date">Date: 3/17/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>安装Redis</h2>
<p>在Ubuntu里，可以直接通过apt安装Redis：</p>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> lsb-release <span class="token function">curl</span> gpg</span>
<span class="line"><span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://packages.redis.io/gpg <span class="token operator">|</span> <span class="token function">sudo</span> gpg <span class="token parameter variable">--dearmor</span> <span class="token parameter variable">-o</span> /usr/share/keyrings/redis-archive-keyring.gpg</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">chmod</span> <span class="token number">644</span> /usr/share/keyrings/redis-archive-keyring.gpg</span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token string">"deb [signed-by=/usr/share/keyrings/redis-archive-keyring.gpg] https://packages.redis.io/deb <span class="token variable"><span class="token variable">$(</span>lsb_release <span class="token parameter variable">-cs</span><span class="token variable">)</span></span> main"</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /etc/apt/sources.list.d/redis.list</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt-get</span> update</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> redis</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">主机与WSL虚拟机的网络通信</header><hr><div class="article-info"><!----><span class="date">Date: 3/16/2025</span><span class="category">Category: </span><span class="tag">Tag: WSL</span></div><div class="excerpt">
<h2>主机到WSL</h2>
<p>在WSL中，执行以下命令可以获得WSL的IP地址：</p>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">hostname</span> <span class="token parameter variable">-I</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">一个最简单的Python包示例</header><hr><div class="article-info"><!----><span class="date">Date: 3/11/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>我写了一个最简单的Python包示例，并详细介绍了各个文件的作用。此外还介绍了如何在开发环境下本地安装包、如何构建包以及如何将包发布到PyPI。</p>
<p>相关内容已经上传到GitHub：<a href="https://github.com/shi0rik0/minimal-python-pkg" target="_blank" rel="noopener noreferrer">shi0rik0/minimal-python-pkg</a>。如果觉得有帮助的话，欢迎给个Star😀。</p>
</div></article><article class="article"><header class="title">Linux下禁用IOMMU的方法</header><hr><div class="article-info"><!----><span class="date">Date: 3/10/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近在安装Isaac Sim的时候，遇到了提醒我关闭IOMMU的警告。下面总结一下在Linux系统中关闭IOMMU的方法。</p>
<p>要关闭IOMMU，最简单的办法是修改内核的启动参数。首先用文本编辑器打开<code>/etc/default/grub</code>，找到<code>GRUB_CMDLINE_LINUX_DEFAULT="..."</code>这一行（如果没有就添加这一行），然后在引号中添加以下内容：</p>
<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">GRUB_CMDLINE_LINUX_DEFAULT="intel_iommu=off amd_iommu=off"</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">一个无聊的问题：第一个版本号究竟是什么？</header><hr><div class="article-info"><!----><span class="date">Date: 3/10/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近强迫症发作，突然想到一个很无聊的问题：软件的第一个版本应该是什么？0.0.1？0.1.0？还是0.0.0？</p>
<p>这种情况我一般会选择随大流或者相信权威。语义化版本（Semantic Versioning）是一个被广泛采用的标准。在<a href="https://semver.org/" target="_blank" rel="noopener noreferrer">Semantic Versioning 2.0.0</a>中，有这样一段话：</p>
<p>How should I deal with revisions in the 0.y.z initial development phase?</p></div></article><article class="article"><header class="title">screen命令常用操作</header><hr><div class="article-info"><!----><span class="date">Date: 3/6/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>新建session</h2>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">screen</span> <span class="token parameter variable">-S</span> session_name</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">如何将包发布到npm</header><hr><div class="article-info"><!----><span class="date">Date: 3/5/2025</span><span class="category">Category: </span><span class="tag">Tag: npm</span></div><div class="excerpt">
<p>首先要在<a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer">npmjs.com</a>上注册一个账号。</p>
<p>在发布包之前，要检查<code>package.json</code>中的<code>name</code>字段是否正确，这个字段就决定了在npm上的包名。</p>
<p>如果没问题，就可以发布了，首先要登录npm账号：</p>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">npm</span> login</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">使用GitHub Pages免费部署静态网站</header><hr><div class="article-info"><!----><span class="date">Date: 3/3/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>要使用GitHub Pages服务部署静态网站，首先要创建一个GitHub仓库。默认情况下，如果你的仓库名字是<code>&lt;username&gt;.github.io</code>，那么你的网站将会被部署到<code>https://&lt;username&gt;.github.io</code>。否则，你的网站将会被部署到<code>https://&lt;username&gt;.github.io/&lt;repository-name&gt;</code>。举个例子，假如你的GitHub用户名是<code>john</code>，那么仓库<code>john.github.io</code>将会被部署到<code>https://john.github.io</code>，而仓库<code>my-website</code>将会被部署到<code>https://john.github.io/my-website</code>。当然，你也可以在设置中使用自定义域名。</p></div></article><article class="article"><header class="title">用PyTorch进行混合精度训练/推理</header><hr><div class="article-info"><!----><span class="date">Date: 2/28/2025</span><span class="category">Category: </span><span class="tag">Tag: 神经网络</span></div><div class="excerpt">
<p>最近尝试了用混合精度的方法来加速模型训练。要用PyTorch进行混合精度训练非常简单，因为PyTorch已经封装好了这个功能，API也很便捷，要import的东西只有下面这些：</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> torch<span class="token punctuation">.</span>amp <span class="token keyword">import</span> autocast<span class="token punctuation">,</span> GradScaler</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">杠杆ETF中隐藏的陷阱</header><hr><div class="article-info"><!----><span class="date">Date: 2/24/2025</span><span class="category">Category: </span><span class="tag">Tag: 理财</span></div><div class="excerpt">
<p>很多人会用杠杆ETF来投资，这样可以用更少的本金博取更多的收益，但是，杠杆ETF存在一个很大的陷阱，那就是它的高损耗率。这里的损耗率不是来自于基金的管理费或者折价/溢价率，而是来自于杠杆ETF的内在机制。</p>
<p>一般的杠杆ETF逻辑是这样的：假设是一个2倍杠杆的ETF，那么这个ETF的净值会保证以下的性质：假设某天其标的资产上涨了1%，那么这个ETF的净值会上涨2%；反之，如果标的资产下跌了1%，那么这个ETF的净值会下跌2%。乍一看，这似乎毫无问题。花10000元投资无杠杆的ETF和花5000元投资2倍杠杆的ETF，应该是等价的。但是，仔细计算一下就会发现问题。</p>
<h2>一个例子</h2></div></article><article class="article"><header class="title">Transformer decoder推理时是否应该设置causal mask</header><hr><div class="article-info"><!----><span class="date">Date: 2/19/2025</span><span class="category">Category: </span><span class="tag">Tag: transformer</span></div><div class="excerpt">
<p>最近在扣关于Transformer的细节，结果发现了一个问题：众所周知，在训练Transformer的过程中，decode的时候要使用causal mask避免泄漏还未生成的信息。在推理的时候，由于我们是逐个生成token的，所以不会出现泄漏的问题，那么是不是就不需要causal mask了呢？后来我看到StackExchange上有个人和我有相同的问题：<a href="https://ai.stackexchange.com/questions/16516/is-the-mask-needed-for-masked-self-attention-during-inference-with-gpt-2" target="_blank" rel="noopener noreferrer">Is the Mask Needed for Masked Self-Attention During Inference with GPT-2</a>。目前我对这个问题的理解是这样的：答案是依然需要。</p></div></article><article class="article"><header class="title">在Electron中读取并显示本地图片</header><hr><div class="article-info"><!----><span class="date">Date: 2/12/2025</span><span class="category">Category: </span><span class="tag">Tag: electron</span></div><div class="excerpt">
<p>最近需要在Electron应用程序中实现读取并显示本地图片的功能。这个功能看起来简单，但实现起来还是会遇到很多坑。这里就总结一下我遇到的问题，并给出一个完整的解决方案。</p>
<h2>两种方案</h2>
<p>首先，Electron是不支持在渲染进程中直接读取本地文件的，所以必须要通过主进程来读取文件。这里有两种方案：</p>
<ol>
<li>利用Electron的<a href="https://www.electronjs.org/docs/latest/api/protocol" target="_blank" rel="noopener noreferrer">Protocol API</a>，将本地文件映射到一个自定义的协议，然后在渲染进程中通过这个协议来读取文件。</li>
<li>直接在主进程中提供一个读取文件的接口，然后在渲染进程中调用这个接口来读取文件。</li>
</ol></div></article><article class="article"><header class="title">Electron IPC教程</header><hr><div class="article-info"><!----><span class="date">Date: 2/10/2025</span><span class="category">Category: </span><span class="tag">Tag: electron</span></div><div class="excerpt">
<h2>Electron的进程模型</h2>
<p>在Electron中，有两种进程：主进程和渲染进程。渲染进程本质上就是一个Chromium的进程，它只负责渲染页面，不能访问Node.js提供的操作系统相关的API。主进程是Node.js的进程，可以访问操作系统的API。主进程和渲染进程之间通过IPC（Inter-Process Communication）进行通信。</p>
<p>这种模型的好处就在于：</p>
<ol>
<li>不需要大幅修改Chromium的源码。</li>
<li>保证了浏览器环境的安全性。</li>
</ol>
<h2>如何使用IPC</h2>
<p>假设我们希望在渲染进程中读取本地文件。</p></div></article><article class="article"><header class="title">日本ACGN资讯网站</header><hr><div class="article-info"><!----><span class="date">Date: 1/23/2025</span><span class="category">Category: </span><span class="tag">Tag: ACGN</span></div><div class="excerpt">
<p>制定去日本的旅行计划的时候，不妨参考一下这些网站。</p>
<h2>联动</h2>
<p><a href="https://collabo-cafe.com/" target="_blank" rel="noopener noreferrer">コラボカフェ</a></p>
<h2>演出等活动</h2>
<p><a href="https://anime.eiga.com/event/" target="_blank" rel="noopener noreferrer">アニメ・声優イベントカレンダー - アニメハック</a></p>
<h2>同人展</h2>
<p><a href="https://shimeken.com/events" target="_blank" rel="noopener noreferrer">同人イベントNAVI</a></p></div></article><article class="article"><header class="title">Git取消追踪文件</header><hr><div class="article-info"><!----><span class="date">Date: 1/19/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>Git 可以用<code>.gitignore</code>来忽略一些文件，但是如果是已经被追踪（track）的文件，将其添加到<code>.gitignore</code>并不会取消追踪。这时候就需要用到<code>git rm --cached</code>命令来手动取消追踪。但是有时候，误追踪的文件自己都不知道，有没有办法可以自动找出所有被追踪，但是原本应该被忽略的文件呢？</p>
<p>查阅 Git 文档之后，发现有两个命令可以实现这个功能：</p>
<ol>
<li><code>git ls-files</code>，这个命令可以列出所有被追踪的文件。</li>
<li><code>git check-ignore --no-index</code>，这个命令可以用来判断某个文件是否被<code>.gitignore</code>忽略。这里必须加上<code>--no-index</code>参数，否则将不会输出已经被追踪的文件。</li>
</ol></div></article><article class="article"><header class="title">PowerShell脚本对于双横线的特殊处理</header><hr><div class="article-info"><!----><span class="date">Date: 1/15/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近在运行<code>npm create vue@latest -- --help</code>的时候，发现一个有趣的现象：如果用 PowerShell 运行这个命令，会输出<code>npm create</code>的帮助信息，而用 cmd 运行就没有问题。后面经过调查，发现是 PowerShell 脚本对于双横线的特殊处理导致的。</p>
<p>npm 针对 cmd 和 PowerShell 提供了两个不同的脚本，分别是<code>npm.cmd</code>和<code>npm.ps1</code>。在 PowerShell 中运行<code>npm</code>的时候，实际上会执行<code>npm.ps1</code>。在 PowerShell 脚本中，<code>--</code>有特殊含义，因此执行<code>npm create vue@latest -- --help</code>就近似于执行<code>npm create vue@latest --help</code>，因此会输出<code>npm create</code>的帮助信息。</p></div></article><article class="article"><header class="title">Python的坑：隐式字符串连接</header><hr><div class="article-info"><!----><span class="date">Date: 1/13/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近写 Python 代码的时候遇到了一个坑：Python 和 C 语言一样，支持隐式字符串连接。所谓隐式字符串连接，就是当两个字符串字面量相邻的时候，会自动连接成一个字符串。比如下面这段代码：</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">s <span class="token operator">=</span> <span class="token string">'hello'</span> <span class="token string">'world'</span></span>
<span class="line"><span class="token keyword">assert</span> s <span class="token operator">==</span> <span class="token string">'helloworld'</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">用setuptools打包资源文件</header><hr><div class="article-info"><!----><span class="date">Date: 1/13/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>默认情况下，setuptools 只会打包 Python 源代码文件，但有时候我们还需要打包一些资源文件，比如配置文件、模板文件、图片等等。这篇文章将会介绍如何用 setuptools 打包资源文件，并在库执行的时候访问这些文件。</p>
<p>我们假设项目的目录结构如下：</p>
<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">myproject/</span>
<span class="line">├── mypkg/</span>
<span class="line">│   ├── __init__.py</span>
<span class="line">│   └── data/</span>
<span class="line">│       ├── template.txt</span>
<span class="line">└── setup.py</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Pinia快速入门</header><hr><div class="article-info"><!----><span class="date">Date: 1/12/2025</span><span class="category">Category: </span><span class="tag">Tag: pinia</span></div><div class="excerpt">
<p>Pinia 是 Vue 3 官方的状态管理库，通俗点说就是可以给 Vue 应用程序提供一个“全局变量”。Pinia 的基本使用方法非常简单。</p>
<h2>导入 Pinia</h2>
<p>首先，我们需要安装 Pinia：</p>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">npm</span> <span class="token function">install</span> pinia</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">在flex布局中实现按比例分配宽度或高度</header><hr><div class="article-info"><!----><span class="date">Date: 1/8/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>需求</h2>
<p>假设我们有这样的布局：</p>
<div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>flex flex-col w-[400px] h-[400px]<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>div 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>div 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>div 3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">代理服务器设置方法</header><hr><div class="article-info"><!----><span class="date">Date: 1/6/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>由于 GFW 的存在，在中国境内访问境外的网站有时候会非常的慢，这时候就只能使用代理，但是有些程序没有使用系统全局的代理设置，需要自己手动配置代理。本文总结了一些需要手动配置的程序的配置方法。</p>
<h2>git</h2>
<p>Git 没有专门针对 HTTPS 协议的代理设置，不管是 HTTP 还是 HTTPS，都是使用 <code>http.proxy</code> 来设置代理。</p>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">git</span> config <span class="token parameter variable">--global</span> http.proxy <span class="token comment"># 查看代理设置</span></span>
<span class="line"><span class="token function">git</span> config <span class="token parameter variable">--global</span> http.proxy http://example.com:8000</span>
<span class="line"><span class="token function">git</span> config <span class="token parameter variable">--global</span> <span class="token parameter variable">--unset</span> http.proxy</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">在Python中更优雅地创建抽象类及接口</header><hr><div class="article-info"><!----><span class="date">Date: 1/5/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>以前我创建抽象类或者接口的时候，通常会这样写：</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">AbstractClass</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">method</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> arg<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">int</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">raise</span> NotImplementedError<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">理清Python的包管理系统</header><hr><div class="article-info"><!----><span class="date">Date: 1/5/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>现代的编程语言都会提供官方的包管理系统，例如 Rust 的 Cargo、Node.js 的 npm、Go 的 go mod 等等。Python 也不例外，但是 Python 的包管理系统非常的混乱，这里主要介绍一下 pip 和 setuptools 这两个工具。</p>
<h2>pip 和 setuptools 的关系</h2>
<p>setuptools 是 Python 的<strong>构建和打包工具</strong>，它负责构建 Python 项目，并将其打包成一个 wheel 文件，而 pip 是 Python 的<strong>包管理工具</strong>，它可以直接安装 wheel 文件，也可以调用 setuptools 来打包项目并安装。pip 还负责管理包的依赖关系，它会在安装包的时候自动安装依赖。</p></div></article><article class="article"><header class="title">Windows的程序文件路径</header><hr><div class="article-info"><!----><span class="date">Date: 1/1/2025</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>在 Windows 系统中，全局的（对于所有用户的）程序文件一般存放在<code>C:\Program Files</code>目录（64 位程序）或者<code>C:\Program Files (x86)</code>目录（32 位程序）下。这两个目录也有对应的环境变量，分别是<code>%PROGRAMFILES%</code>和<code>%PROGRAMFILES(X86)%</code>。</p>
<p>这两个目录下的文件受到系统保护，除非有管理员权限，否则只能读取，不能修改。这就是为什么软件在全局安装的时候一定会请求管理员权限。</p>
<p>程序运行过程中，有时候会需要创建或修改一些文件，比如配置文件或者临时文件等等，这种情况下，如果将这些文件放在<code>%PROGRAMFILES%</code>下就会很不方便。用户肯定不希望每次运行程序都要授予管理员权限。所以这些文件一般会放在用户目录下，比如<code>C:\Users\&lt;username&gt;\AppData\Local</code>目录。这个目录也有对应的环境变量，是<code>%LOCALAPPDATA%</code>。</p></div></article><article class="article"><header class="title">在pybind11中操作numpy数组</header><hr><div class="article-info"><!----><span class="date">Date: 12/29/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近需要给 Python 写一个涉及 numpy 数组操作的 C++扩展。我用的是<code>pybind11</code>，用这个库写 Python C++拓展非常方便，并且这个库也提供了对于 numpy API 的封装，可惜<a href="https://pybind11.readthedocs.io/en/stable/advanced/pycpp/numpy.html" target="_blank" rel="noopener noreferrer">官方文档</a>写得比较晦涩，并且也不太全面。我结合官方文档和源代码，总结了一下 numpy 数组的操作方法。</p>
<h2>头文件</h2></div></article><article class="article"><header class="title">关于C++编译器的警告开关</header><hr><div class="article-info"><!----><span class="date">Date: 12/28/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>C++编译器（主要是 GCC 和 Clang）都会提供一些控制警告的编译选项，这些选项的格式通常是<code>-W&lt;name&gt;</code>或者<code>-Wno-&lt;name&gt;</code>，其中<code>&lt;name&gt;</code>是警告的名称。例如<code>-Wuninitialized</code>表示启用“未初始化变量”的警告，<code>-Wno-unused-variable</code>表示禁用“未使用变量”的警告。</p>
<p>由于警告有很多种类，逐一启用会非常麻烦，因此编译器也提供了一些选项来批量启动警报，其中一个很有误导性的选项是<code>-Wall</code>。很多人会误以为这个选项会启用所有警告，但实际上这只会启用一部分警报。如果想要启用更多警告，可以再添加<code>-Wextra</code>选项。但是就算使用<code>-Wall -Wextra</code>也仍然不会启用所有警告。</p></div></article><article class="article"><header class="title">setuptools的setup()函数的常用参数</header><hr><div class="article-info"><!----><span class="date">Date: 12/28/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>本文将介绍<code>setuptools</code>的<code>setup()</code>函数的常用参数，主要参考的是<a href="https://setuptools.pypa.io/en/latest/references/keywords.html" target="_blank" rel="noopener noreferrer">官方文档</a>。</p>
<h3>name</h3>
<p>包的名称，要将下划线替换为短横线，例如<code>my-package</code>。</p>
<h3>version</h3>
<p>版本号，例如<code>1.2.3</code>。</p></div></article><article class="article"><header class="title">在Vite项目中使用Tailwind CSS</header><hr><div class="article-info"><!----><span class="date">Date: 12/19/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>本文介绍如何在现有的 Vite 项目中使用 Tailwind CSS。</p>
<p>首先要安装 Tailwind CSS：</p>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">-D</span> tailwindcss postcss autoprefixer</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">关于clangd的配置文件</header><hr><div class="article-info"><!----><span class="date">Date: 12/18/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>clangd 是一个可以分析 C++代码，并帮助编辑器进行代码补全、跳转等功能的工具，但是 clangd 不会自动分析项目的 include 路径、编译选项等信息，这些信息需要通过配置文件来提供。clangd 支持两种配置文件，第一种是<code>compile_commands.json</code>，这个文件会给项目中的每一个源文件分别指定编译选项，通常这个文件是由程序自动生成的。第二种则是<code>compile_flags.txt</code>，这个文件会给项目中的所有文件指定相同的编译选项，这个文件往往是手动编写的。</p>
<h2>配置文件的查找路径</h2>
<p>clangd 的文档写得不是很清楚，根据我所了解的信息，clangd 查找配置文件的逻辑大概是这样的：</p></div></article><article class="article"><header class="title">在脚本中使用相对路径的一种方法</header><hr><div class="article-info"><!----><span class="date">Date: 12/11/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>在软件项目中，经常需要写一些脚本来自动化执行一些任务。这里就有一个问题，脚本中的相对路径应该以什么为基准？目前我见过的常用方法有两种：</p>
<ol>
<li>
<p>以当前工作目录（CWD）为基准。这种方法是最简单直接的，但是缺点也很明显。首先是在终端执行脚本的时候，就必须在正确的目录下执行。其次就是当其他进程调用脚本时，也必须确保 CWD 设置正确。事实上，CWD 可以看作是操作系统提供的一个进程级别的全局变量。本身依赖于全局变量就不是一件非常优雅的事情。</p>
</li>
<li>
<p>以脚本文件所在目录为基准。这种方法克服了上一种方法的缺点，但是却带来了一个新的问题：如果脚本文件被移动，那么脚本中的相对路径也要随之修改。</p>
</li>
</ol></div></article><article class="article"><header class="title">关于sudo的secure_path设置</header><hr><div class="article-info"><!----><span class="date">Date: 12/11/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>sudo 有一个名为<code>secure_path</code>的设置，从 sudo 1.9.16 开始，<code>secure_path</code>设置会默认启用。<a href="https://www.sudo.ws/posts/2024/09/why-sudo-1.9.16-enables-secure_path-by-default/" target="_blank" rel="noopener noreferrer">官方博客</a>介绍了这个改动的原因。</p>
<p>当使用 sudo 执行命令的时候，用户当前的环境变量会被修改。其中<code>PATH</code>会被设置为<code>secure_path</code>的值。因此，经常会发生加了<code>sudo</code>之后就找不到命令的情况。解决方法也是非常的简单，要么修改<code>secure_path</code>的值，要么直接删除这个设置，这样 sudo 就不会修改<code>PATH</code>了。</p></div></article><article class="article"><header class="title">用sudo命令切换至root用户的正确方式</header><hr><div class="article-info"><!----><span class="date">Date: 12/10/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近遇到了一个问题：我想查看一个只有 root 用户才有权限访问的目录下有哪些文件，于是我尝试用<code>sudo cd /path/to/dir</code>命令切换当前目录，结果报错。后来才知道<code>cd</code>并不是一个真实存在的可执行文件，而是一个 Shell 内置的特殊命令。所以，要通过<code>cd</code>切换目录，就只能把当前 Shell 的用户切换成 root 才行。</p>
<p>那么，将当前 Shell 的用户切换成 root，应该怎么做呢？我在网上看到了许多方法，包括<code>sudo su</code>、<code>sudo -s</code>等等。这些命令都能奏效，那么到底应该用哪个呢？我看到 StackOverflow 上有<a href="https://askubuntu.com/a/1165222" target="_blank" rel="noopener noreferrer">一篇回答</a>总结得很好：</p></div></article><article class="article"><header class="title">用Python实现经典设计模式（更新中）</header><hr><div class="article-info"><!----><span class="date">Date: 12/6/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>观察者模式（Observer Pattern）</h2>
<p>所谓观察者模式，就是一个简单的消息通知机制。当一个对象想要发送消息时，订阅了这个消息的对象会收到通知。</p>
<p>假设我们有一个杂志社<code>MagazinePublisher</code>，它有很多订阅者<code>Subscriber</code>，当杂志社有新的杂志发布时，会通知所有的订阅者。</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">Subscriber</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name</span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string"> received message: </span><span class="token interpolation"><span class="token punctuation">{</span>message<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">MagazinePublisher</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>subscribers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">add_subscriber</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> subscriber<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>subscribers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>subscriber<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">remove_subscriber</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> subscriber<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>subscribers<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>subscriber<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">notify_subscribers</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">for</span> subscriber <span class="token keyword">in</span> self<span class="token punctuation">.</span>subscribers<span class="token punctuation">:</span></span>
<span class="line">            subscriber<span class="token punctuation">.</span>update<span class="token punctuation">(</span>message<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">subscriber1 <span class="token operator">=</span> Subscriber<span class="token punctuation">(</span><span class="token string">'Alice'</span><span class="token punctuation">)</span></span>
<span class="line">subscriber2 <span class="token operator">=</span> Subscriber<span class="token punctuation">(</span><span class="token string">'Bob'</span><span class="token punctuation">)</span></span>
<span class="line">publisher <span class="token operator">=</span> MagazinePublisher<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">publisher<span class="token punctuation">.</span>add_subscriber<span class="token punctuation">(</span>subscriber1<span class="token punctuation">)</span></span>
<span class="line">publisher<span class="token punctuation">.</span>add_subscriber<span class="token punctuation">(</span>subscriber2<span class="token punctuation">)</span></span>
<span class="line">publisher<span class="token punctuation">.</span>notify_subscribers<span class="token punctuation">(</span><span class="token string">'New magazine is published!'</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Windows NTP指南</header><hr><div class="article-info"><!----><span class="date">Date: 12/5/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>本文将介绍如何在 Windows 系统上启动 NTP 服务器，以及如何让 NTP 客户端同步时间。</p>
<p>注意：本文中的大部分操作都需要管理员权限。</p>
<h2>防火墙配置</h2>
<p>默认配置下，Windows 防火墙会阻止所有未经允许的入站连接。因此，我们需要允许 NTP 服务（使用 UDP 123 端口）的入站连接。</p>
<div class="language-powershell line-numbers-mode" data-highlighter="prismjs" data-ext="powershell"><pre><code><span class="line"><span class="token function">New-NetFirewallRule</span> <span class="token operator">-</span>DisplayName <span class="token string">"Allow NTP"</span> <span class="token operator">-</span>Direction Inbound <span class="token operator">-</span>Protocol UDP <span class="token operator">-</span>LocalPort 123 <span class="token operator">-</span>Action Allow</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Windows环境下Python UTF-8编码的一些坑</header><hr><div class="article-info"><!----><span class="date">Date: 11/30/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>众所周知，Python 3 相比 Python 2 最大的变化之一就是字符串强制使用 UTF-8 编码，但这并不意味着使用 Python 3 就不会有字符编码的问题。在 Python 的世界里，确实一切皆 UTF-8，但是一旦和操作系统交互，就可能会出现问题。</p>
<h2>open()的默认编码</h2>
<p>在 Unix 系统上，open()函数的默认编码是 UTF-8，但是在 Windows 系统上，open()函数的默认编码是 ANSI（也就是根据 Windows 的地区设置而定，在中文 Windows 上一般是 GBK 编码）。因此，如果在 Windows 系统上要让 open()函数使用 UTF-8 编码，就需要显式指定编码：</p></div></article><article class="article"><header class="title">给VSCode Vue项目配置ESLint和Prettier</header><hr><div class="article-info"><!----><span class="date">Date: 11/25/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>什么是 ESLint 和 Prettier</h2>
<p>ESLint 是一个专门针对 JS 程序的 linter，但是它也可以用来格式化 JS 代码。而 Prettier 是一个支持多种语言（包括 JS）的代码 formatter。Linter 和 formatter 的区别在于，formatter 只关注代码格式好不好看，不关心具体逻辑，而 linter 更关注程序逻辑是否有问题。</p>
<p>所以说，对于 HTML 和 CSS 代码，只能用 Prettier 来格式化。而对于 JS 代码来说，ESLint 和 Prettier 的功能有重复的部分。比较好的做法是，禁用 ESLint 中与 Prettier 冲突的格式化规则，然后同时使用 ESLint 和 Prettier。</p></div></article><article class="article"><header class="title">关于npm install的开发依赖</header><hr><div class="article-info"><!----><span class="date">Date: 11/25/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p><code>npm</code>在管理依赖的时候，会将依赖分为生产依赖和开发依赖。生产依赖就是运行的时候用到的依赖，而开发依赖则是测试框架、linter 等开发时才会用到的辅助工具。</p>
<p>如果你用<code>npm install {package}</code>，那么默认就是作为生产依赖去安装。要安装一个开发依赖，就要指定<code>--save-dev</code>或者<code>-D</code>：</p>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">npm</span> <span class="token function">install</span> --save-dev <span class="token punctuation">{</span>package<span class="token punctuation">}</span></span>
<span class="line"><span class="token comment"># 或者</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">-D</span> <span class="token punctuation">{</span>package<span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Ubuntu安装PostgreSQL的教程</header><hr><div class="article-info"><!----><span class="date">Date: 11/20/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>安装</h2>
<p>使用包管理器就可以直接安装 PostgreSQL：</p>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> postgresql</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">给boto3增加type hints</header><hr><div class="article-info"><!----><span class="date">Date: 11/15/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近使用<code>boto3</code>的时候，发现<code>boto3.client()</code>的返回值没有标注类型，导致开发的时候很不方便。我原先以为是<code>boto3</code>的开发者忘了添加，后来看了源代码才知道，<code>boto3.client()</code>返回的对象的 class 是在运行时动态生成的，所以很难进行 type hints。（这就是动态语言的坏处啊！）</p>
<p>好在有个开发者生成了<code>boto3</code>各种 client 的 stub，包名叫<code>boto3-stubs</code>。假如使用的是 S3 client，就输入：</p></div></article><article class="article"><header class="title">将本地机器的SSH密钥添加到远程机器的方法</header><hr><div class="article-info"><!----><span class="date">Date: 11/13/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>用密码进行 SSH 登入麻烦又不安全。这篇文章将会教你如何将本地机器的 SSH 密钥添加到远程机器，用密钥快速登入 SSH。</p>
<p>首先，如果是 Windows 系统，建议安装下 Git for Windows，哪怕你不用 Git。因为 Git for Windows 附带了 SSH 客户端工具，以及兼容 Linux 的 Git Bash。</p>
<p>如果你的电脑上还没有 SSH 密钥，就输入下面的命令生成一个：</p>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">ssh-keygen <span class="token parameter variable">-t</span> ed25519 <span class="token parameter variable">-C</span> <span class="token string">"your_email@example.com"</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Django外键的on_delete参数</header><hr><div class="article-info"><!----><span class="date">Date: 11/11/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>在 Django 的 ORM 框架中，通过<code>models.ForeignKey</code>可以很方便地创建外键字段。请看下面的例子：</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models</span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Manufacturer</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    name <span class="token operator">=</span> models<span class="token punctuation">.</span>TextField<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Car</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    manufacturer <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Manufacturer<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>PROTECT<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Python标准库的functools.wraps装饰器</header><hr><div class="article-info"><!----><span class="date">Date: 11/4/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近写代码的时候，发现给一个函数加了装饰器后就会报错。后来发现是因为装饰器抹去了原函数的 type hints 信息，导致后续逻辑出错。Python 的函数对象有很多 metadata，比如函数名、docstring、type hints 等，<code>functools.wraps</code>装饰器的作用就是复制这些 metadata。</p>
<p>请看下面的示例：</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> functools <span class="token keyword">import</span> wraps</span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">decorator</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">new_func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        func<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> new_func</span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">decorator_with_wraps</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token decorator annotation punctuation">@wraps</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">new_func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        func<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> new_func</span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@decorator</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">pass</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@decorator_with_wraps</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">pass</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>__name__<span class="token punctuation">)</span>  <span class="token comment"># 输出：new_func</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span>__name__<span class="token punctuation">)</span>  <span class="token comment"># 输出：g</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">用CloudFlare Workers建立免费的Docker Hub镜像</header><hr><div class="article-info"><!----><span class="date">Date: 10/31/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>2024 年 12 月 28 日更新：似乎<a href="https://linux.do/t/topic/297635" target="_blank" rel="noopener noreferrer">有消息</a>称 CloudFlare 更新了用户条款，禁止将其服务用于代理用途。因此这个方法可能有风险。</p>
<p>由于中国封锁了 Docker Hub，导致在国内用 Docker 的时候会遇到很多问题。一个最简单的办法就是使用镜像，然而很遗憾的是，很多镜像站也被封锁了，因此我不得不自己建立一个 Docker Hub 镜像。在 GitHub 上，我发现一个<a href="https://github.com/ciiiii/cloudflare-docker-proxy" target="_blank" rel="noopener noreferrer">使用 CloudFlare Workers 建立 Docker Hub 镜像的项目</a>。CloudFlare Workers 是有免费版的，这就意味着可以免费建立一个 Docker Hub 镜像。然而原项目的 README 文档写得实在是太简陋了，我摸索了很久才最终测试成功，因此就将一个更详细的步骤写在这里。</p></div></article><article class="article"><header class="title">域名的 DNS 设置</header><hr><div class="article-info"><!----><span class="date">Date: 10/30/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>当我们购买了一个域名之后，必须要做的一件事就是将域名绑定到服务器的 IP 地址上。这个过程是通过在域名注册商那里修改 DNS 设置实现的。当我们在域名注册商那里购买一个域名之后，我们就可以通过域名注册商的控制面板来管理域名的 DNS 设置。</p>
<h2>指定 DNS 服务器</h2>
<p>通常来说，域名注册商会有自己的 DNS 服务器。默认情况下，域名会使用域名注册商自己的 DNS 服务器，但我们也可以改为第三方的 DNS 服务器。下图是 GoDaddy 的配置页面，图中我选择使用 CloudFlare 的 DNS 服务器。</p>
<p></p>
<h2>修改 DNS 记录</h2></div></article><article class="article"><header class="title">关于CSRF攻击及其防御</header><hr><div class="article-info"><!----><span class="date">Date: 10/25/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>什么是CSRF攻击</h2>
<p>CSRF 攻击是利用了浏览器的一个安全漏洞。假设用户在 a.com 上登入，浏览器获得了 cookie，接下来如果用户访问 b.com，而 b.com 访问了 a.com，则浏览器会将 cookie 附加在请求上，从而可能在用户不知情的情况下以登入权限进行了 a.com 的操作。尽管较新的浏览器修复了部分漏洞，但是由于要保持互联网的兼容性，因此并没有完全修复这个问题，并且我们不能假设用户使用的都是较新的浏览器，因此对 CSRF 攻击进行防御还是有必要的。</p>
<h2>如何防御CSRF攻击</h2>
<h3>浏览器发起请求的两种分类</h3>
<p>要防御 CSRF 攻击，首先要知道在什么情况下，访问 b.com 的时候浏览器会对 a.com 发起请求。主要有两种情况：</p></div></article><article class="article"><header class="title">Windows下Docker对路径斜杠处理的一个bug</header><hr><div class="article-info"><!----><span class="date">Date: 10/22/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近在 Windows 下使用 Docker 的时候遇到了一个 bug。起因是我需要将 host 上的一个文件挂载到 Docker 容器里，于是我就执行了以下命令：</p>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">docker</span> run <span class="token parameter variable">-v</span> ./foo.txt:/tmp/foo.txt ubuntu</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Docker Compose确保Postgres启动的方法</header><hr><div class="article-info"><!----><span class="date">Date: 10/16/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近我编写了一个 Django + Postgres 的网站，其 docker-compose.yml 大概是下面这样的：</p>
<div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code><span class="line"><span class="token key atrule">services</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">db</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">image</span><span class="token punctuation">:</span> postgres</span>
<span class="line"></span>
<span class="line">  <span class="token key atrule">web</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">image</span><span class="token punctuation">:</span> django</span>
<span class="line">    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> db</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Dockerfile中CMD和ENTRYPOINT的区别</header><hr><div class="article-info"><!----><span class="date">Date: 10/14/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>在 Dockerfile 中有两个命令<code>CMD</code>和<code>ENTRYPOINT</code>，它们都可以用来指定 Docker 镜像启动时的默认命令，那么它们究竟有什么区别呢？</p>
<p>我在网上看到<a href="https://aws.amazon.com/cn/blogs/opensource/demystifying-entrypoint-cmd-docker/" target="_blank" rel="noopener noreferrer">一篇博客文章</a>很好地解释了两者的区别。简而言之，最终运行<code>docker run</code>命令的时候，容器执行的命令会是 ENTRYPOINT + CMD，但是有以下几点需要注意：</p></div></article><article class="article"><header class="title">Attention层的简单讲解</header><hr><div class="article-info"><!----><span class="date">Date: 10/2/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>输入与输出的维度</h2>
<p>Attention 层是用来处理序列输入的，所以它接受的输入是一个二维的$n \times N_i$的矩阵，而输出则是一个$n \times N_o$的矩阵。$n$是输入序列的 token 个数，$N_i$则是 embedding 向量的长度，$N_o$则是输出的状态向量的长度。理论上 Attention 层对于$n$没有限制，而$N_i$和$N_o$则是模型的超参数。</p>
<h2>Attention 层的超参数</h2>
<p>除了$N_i$和$N_o$以外，Attention 层还有其他超参数。</p>
<p>一个 Attention 层包含 3 个全连接层，分别叫做 Query、Key 和 Value，用符号$Q$、$K$和$V$表示。这 3 个全连接层的输入维度都是$N_i$，而输出维度都是超参数，分别为$D_q$、$D_k$和$D_v$。稍后会看到，Attention 层要求$D_q=D_k$以及$D_v=N_o$。</p></div></article><article class="article"><header class="title">docker compose up的build选项</header><hr><div class="article-info"><!----><span class="date">Date: 10/2/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>从本地的 Dockerfile 构建镜像启动 Docker Compose 的时候（比如像下面的配置），</p>
<div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code><span class="line"><span class="token key atrule">services</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">service0</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">build</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">context</span><span class="token punctuation">:</span> .</span>
<span class="line">      <span class="token key atrule">dockerfile</span><span class="token punctuation">:</span> Dockerfile</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">关于.dockerignore的陷阱</header><hr><div class="article-info"><!----><span class="date">Date: 9/24/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>在 Docker 构建镜像的时候，默认会将 context 下的所有文件打包发送到 builder 进程。这是因为 Docker builder 采用了一种客户端/服务器的架构，这样就可以实现远程构建。但是如果 context 下面文件很大，就会影响构建速度。为此，Docker 提供了一个机制，可以通过在<code>.dockerignore</code>文件中指定要排除的文件。但是这个.dockerignore 的语法和.gitignore 有很大差异，因此很容易写错，其中一个陷阱就是，在.gitignore 中，<code>foo</code>等价于<code>**/foo</code>，而在.dockerignore 中，这等价于<code>/foo</code>。除此之外还有很多微妙的差异，比如<a href="https://zzz.buzz/2018/05/23/differences-of-rules-between-gitignore-and-dockerignore/" target="_blank" rel="noopener noreferrer">这篇文章</a>中指出的：</p></div></article><article class="article"><header class="title">关于Docker的当前目录</header><hr><div class="article-info"><!----><span class="date">Date: 9/20/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近被 Docker 的当前目录位置整得有些混乱，特地在此整理一下。</p>
<h2>Docker Build</h2>
<p>执行<code>docker build</code>命令的时候，需要传入一个 positional 参数，这个参数就是 context。举个例子，假如当前 shell 的目录是<code>/root</code>，我们执行以下命令：</p>
<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">docker</span> build <span class="token parameter variable">-f</span> dockerfiles/a.Dockerfile dockerfiles</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Vite配置开发/生产环境下的环境变量</header><hr><div class="article-info"><!----><span class="date">Date: 9/20/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>在<code>vite.config.js</code>里面有一个<code>envDir</code>的选项，用来指定 Vite 加载的环境变量的路径，默认值是项目的根目录，可以改为其他值：</p>
<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">envDir</span><span class="token operator">:</span> <span class="token string">"env"</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">现代HTML的最简模板</header><hr><div class="article-info"><!----><span class="date">Date: 9/17/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>下面是使用 Vite 创建的前端项目的默认<code>index.html</code>文件内容：</p>
<div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html"><pre><code><span class="line"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>icon<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/favicon.ico<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Vite App<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">关于SysVinit和systemd</header><hr><div class="article-info"><!----><span class="date">Date: 9/14/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>Linux 管理服务的系统有两种：SysVinit 和 systemd。systemd 比 SysVinit 推出得更晚。SysVinit 本质上就是运行一些管理服务的 shell 脚本，轻量灵活但是简陋，而 systemd 则是一个封装得更加复杂的系统。现在大多数 Linux 发行版都已经使用 systemd 了，但是在 Docker 环境下，由于种种原因，大多数情况下还是会使用 SysVinit。因此，同时掌握这两种系统还是很有必要的。</p>
<h2>用 systemd 管理服务</h2>
<p>systemd 管理服务的命令是<code>systemctl</code>。</p></div></article><article class="article"><header class="title">使用pypdf库提取PDF文件中的图片</header><hr><div class="article-info"><!----><span class="date">Date: 9/13/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近我遇到了这么一个问题：我用扫描仪扫描出来的文件是 PDF 格式的，然而我希望得到的是图片格式。从理论上说，扫描仪生成的 PDF 文件应该也只是图片的集合，因此只需要解析 PDF 文件就可以提取了。有一个名为<code>pypdf</code>的 Python 库就可以解析 PDF 文件中的对象。</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> pypdf <span class="token keyword">import</span> PdfReader</span>
<span class="line"></span>
<span class="line">reader <span class="token operator">=</span> PdfReader<span class="token punctuation">(</span><span class="token string">'test.pdf'</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">for</span> p <span class="token keyword">in</span> reader<span class="token punctuation">.</span>pages<span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> p<span class="token punctuation">.</span>images<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token punctuation">.</span>data<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Nginx入门教程</header><hr><div class="article-info"><!----><span class="date">Date: 9/5/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>启动、终止与重新加载</h2>
<p>启动 nginx：</p>
<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">nginx -c conf/nginx.conf</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Windows家庭版关闭BitLocker</header><hr><div class="article-info"><!----><span class="date">Date: 7/20/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>现在很多笔记本出厂时会默认启用 BitLocker。通过运行<code>manage-bde -status</code>命令可以查看分区是否有启用 BitLocker（这个命令需要管理员权限）。</p>
<p>如果是家庭版的 Windows（可以通过运行<code>winver</code>确认），那么 BitLocker 可以用系统设置的“隐私和安全性”-&gt;“设备加密”进行设置。这个“设备加密”就是家庭版 Windows 自带的阉割版 BitLocker。关闭“设备加密”就可以解密了。解密完成后，可以通过运行<code>manage-bde -status</code>命令确认是否已经解密成功。</p></div></article><article class="article"><header class="title">关于VSCode的launch.json</header><hr><div class="article-info"><!----><span class="date">Date: 7/20/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>VSCode 工作区的<code>.vscode/launch.json</code>文件中存储着调试和运行的配置。</p>
<h2>基本结构</h2>
<p><code>launch.json</code>的基本结构如下：</p>
<div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.2.0"</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">"configurations"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"foo"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"debugpy"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"request"</span><span class="token operator">:</span> <span class="token string">"launch"</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">"program"</span><span class="token operator">:</span> <span class="token string">"${workspaceFolder}/bar.py"</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">// ...</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">解决Pixel 8无法使用中国SIM卡接打电话的问题</header><hr><div class="article-info"><!----><span class="date">Date: 7/19/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近购买了一台日版的 Pixel 8，发现使用国内的 SIM 卡的时候可以流量上网，但无法正常接打电话和收发短信。经过调查，发现问题的根源是这样的：</p>
<ol>
<li>由于 Pixel 手机没有在国内上市，所以谷歌在 Pixel 上加了地区锁，导致国内 SIM 卡无法使用 5G，最多只能用到 4G。</li>
<li>国内的 4G 通信基本上都使用了一种名为 VoLTE 的技术。这种技术需要手机的配置文件里有运营商的信息。由于 Pixel 手机没有在国内上市，自然 Pixel 里面也没有写入国内运营商的信息，因此无法使用 VoLTE。</li>
</ol>
<p>综上所述，解决办法有两种：如果是 5G SIM 卡，那么可以尝试 root 之后解开地区锁使用 5G。还有一种更通用的办法是修改配置文件，让 Pixel 能够使用 4G VoLTE。修改配置文件无需 root。</p></div></article><article class="article"><header class="title">用Python的zipfile标准库解压非标准编码的zip压缩包</header><hr><div class="article-info"><!----><span class="date">Date: 7/19/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>时至今日（2024 年），依然有很多日本的 zip 压缩包采用 Shift JIS 编码。使用 7-Zip 等软件解压这些压缩包的时候，会发现文件名都是乱码。WinRAR 支持指定压缩包的文本编码，但是我个人不怎么喜欢 WinRAR。因此，我决定使用 Python 的标准库来解压非标准编码的 zip 压缩包。</p>
<p>对于 3.11 及 3.11 之后的 Python 版本，<code>ZipFile</code>提供了一个<code>metadata_encoding</code>的参数，通过指定这个参数就可以设置编码：</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> zipfile</span>
<span class="line"></span>
<span class="line"><span class="token keyword">with</span> zipfile<span class="token punctuation">.</span>ZipFile<span class="token punctuation">(</span><span class="token string">'foo.zip'</span><span class="token punctuation">,</span> metadata_encoding<span class="token operator">=</span><span class="token string">'cp932'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">    f<span class="token punctuation">.</span>extractall<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">关于在data warehouse中实例化view的优化问题</header><hr><div class="article-info"><!----><span class="date">Date: 7/14/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>问题背景</h2>
<p>假设我们有一个名为 SalesTable 的 SQL 表格，这个表格有 4 列：time_、kind、shop 和 sales，分别代表某个时间段内某个种类的商品在某家商店的销售额。</p>
<p>假如我们需要统计每个时间段内每个种类商品的销售总额，那么我们可以这么编写 SQL 语句：</p>
<div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> time_<span class="token punctuation">,</span> kind<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>sales<span class="token punctuation">)</span> <span class="token keyword">FROM</span> SalesTable <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> time_<span class="token punctuation">,</span> kind<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">数据分析中的association问题及其算法</header><hr><div class="article-info"><!----><span class="date">Date: 7/7/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>问题定义</h2>
<p>顾客的交易记录可以用一个$m \times n$的矩阵来表示，如果第$i$个顾客购买了第$j$个商品，矩阵的第$i$行第$j$列就为 1，否则为 0。</p>
<p>接下来定义 3 个新概念：association、support 和 confidence。</p>
<p>一个 association 可以用$X \to Y$来表示，其中$X$和$Y$都是商品的集合，$X \cap Y = \emptyset$。</p>
<p>一个商品集合的 support 是指交易记录中包含这些商品的交易的个数。一个 association 的 support 是指$X \cup Y$的 support。</p></div></article><article class="article"><header class="title">3种决策树：ID3、C4.5和CART</header><hr><div class="article-info"><!----><span class="date">Date: 7/7/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>假设有以下数据集，记录着一些人的种族、收入、是否有子女以及他们是否有购买保险：</p>
<table>
<thead>
<tr>
<th>Race</th>
<th>Income</th>
<th>Child</th>
<th>Insurance</th>
</tr>
</thead>
<tbody>
<tr>
<td>B</td>
<td>H</td>
<td>N</td>
<td>Y</td>
</tr>
<tr>
<td>W</td>
<td>H</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td>W</td>
<td>L</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td>W</td>
<td>L</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td>B</td>
<td>L</td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>B</td>
<td>L</td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>B</td>
<td>L</td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>W</td>
<td>L</td>
<td>N</td>
<td>N</td>
</tr>
</tbody>
</table></div></article><article class="article"><header class="title">Python标准库的简易HTTP服务器</header><hr><div class="article-info"><!----><span class="date">Date: 6/30/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>Python 标准库有一个名为<code>http.server</code>的模块，提供了简易的 HTTP 服务器功能。下面的示例代码用这个模块启动了一个简单的 HTTP 服务器。这个服务器只支持 POST 方法，会打印 POST 请求的信息，并返回一个固定的字符串。</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> http<span class="token punctuation">.</span>server <span class="token keyword">import</span> BaseHTTPRequestHandler<span class="token punctuation">,</span> HTTPServer</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">MyHandler</span><span class="token punctuation">(</span>BaseHTTPRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">do_POST</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'method:'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>command<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'path:'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>path<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'HTTP version:'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>request_version<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'headers:'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>headers<span class="token punctuation">)</span></span>
<span class="line">        content_length <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Content-Length'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">        body <span class="token operator">=</span> self<span class="token punctuation">.</span>rfile<span class="token punctuation">.</span>read<span class="token punctuation">(</span>content_length<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'body:'</span><span class="token punctuation">,</span> body<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        response <span class="token operator">=</span> <span class="token string">b'Roger!'</span></span>
<span class="line">        self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>send_header<span class="token punctuation">(</span><span class="token string">'Content-Length'</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>response<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span></span>
<span class="line">    server <span class="token operator">=</span> HTTPServer<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">,</span> MyHandler<span class="token punctuation">)</span></span>
<span class="line">    server<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Ubuntu常用软件包</header><hr><div class="article-info"><!----><span class="date">Date: 6/23/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>下面列出的软件包主要是命令名称和包名不一致的软件包。</p>
<table>
<thead>
<tr>
<th>包名</th>
<th>提供的命令</th>
</tr>
</thead>
<tbody>
<tr>
<td>build-essential</td>
<td>gcc, g++, make</td>
</tr>
<tr>
<td>iproute2</td>
<td>ip</td>
</tr>
<tr>
<td>iputils-ping</td>
<td>ping</td>
</tr>
</tbody>
</table>
</div></article><article class="article"><header class="title">关于Pydantic model字段的别名</header><hr><div class="article-info"><!----><span class="date">Date: 6/22/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>给 model 字段指定别名</h2>
<p>Pydantic 的 model 字段名是通过 Python 的类型注解设定的。这样一来当 schema 的字段名不是合法的 Python 变量名的时候就会带来问题。这种情况下可以用 Field 对象的 alias 属性来给字段指定名称。例如下面的例子给<code>family_name</code>这个字段设定了别名<code>family-name</code>。</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> pydantic <span class="token keyword">import</span> BaseModel<span class="token punctuation">,</span> Field</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    family_name<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> Field<span class="token punctuation">(</span>alias<span class="token operator">=</span><span class="token string">'family-name'</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">json_str <span class="token operator">=</span> <span class="token string">'{"family-name": "Smith"}'</span></span>
<span class="line">person <span class="token operator">=</span> Person<span class="token punctuation">.</span>model_validate_json<span class="token punctuation">(</span>json_str<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>model_dump_json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">使用Docker搭建PySpark学习环境</header><hr><div class="article-info"><!----><span class="date">Date: 6/20/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>首先安装 Docker，然后拉取 Spark 的 Docker 镜像：</p>
<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">docker pull apache/spark</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">Python的代码格式化程序对比</header><hr><div class="article-info"><!----><span class="date">Date: 6/19/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>知名的 Python 代码格式化程序主要有 3 个：<a href="https://github.com/hhatto/autopep8" target="_blank" rel="noopener noreferrer">autopep8</a>、<a href="https://github.com/psf/black" target="_blank" rel="noopener noreferrer">black</a>和<a href="https://github.com/google/yapf" target="_blank" rel="noopener noreferrer">yapf</a>。其中 autopep8 是最古老的，它的开发已经不是很活跃了，因此不推荐使用。black 和 yapf 的区别主要在于 yapf 提供了更多的格式化选项，让程序员可以根据自己的喜好调节代码风格。而 black 的作者有比较严重的洁癖，主张所有的 Python 代码都应该是统一的风格，因此几乎没有提供自定义选项。black 甚至会强制要求字符串用双引号包裹。由于本人没有强迫症，因此还是更倾向于使用 yapf。</p></div></article><article class="article"><header class="title">Python内置函数的key参数</header><hr><div class="article-info"><!----><span class="date">Date: 6/19/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>Python 内置的 sort()、sorted()、max()和 min()都有一个可选的 key 参数。通过这个参数可以指定比较的基准。下面提供一些范例。</p>
<p>下面的代码会将 list 中的点按照 l2-norm 排序：</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">+</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">BT种子文件和磁力链的区别</header><hr><div class="article-info"><!----><span class="date">Date: 6/16/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>在 BT 分享网站上，经常可以看见一个资源有两种下载方式：BT 种子文件或者磁力链。使用这两种方式有什么区别呢？先下结论：磁力链只存储了 BT 种子文件部分内容的 hash 值。使用磁力链下载文件的时候，要首先从拥有资源的节点上根据 hash 值获得 BT 种子文件，然后才能下载。因此可以说磁力链只是一个中间过程，BT 种子文件才是最终的结果。</p>
<p>接下来将首先介绍使用 BT 协议下载文件的时候需要的信息，然后将分别介绍 BT 种子文件和磁力链分别存储了哪些信息。</p>
<h2>BT 协议需要的信息</h2>
<p>要让 BT 协议工作，需要两个最关键的信息。第一个是 tracker 服务器的地址。第二个是文件名及其 hash 值。Tracker 服务器的作用是让需要下载资源的节点能够发现拥有资源的节点。在这两个信息中，文件名及其 hash 值显然是更重要的，因为没有这个信息，我们就无法确定要下载的文件。至于 tracker 服务器地址这个信息其实并不是那么重要，因为 tracker 服务器并不是唯一且固定的，知名的 tracker 服务器列表在互联网上都可以查到，所以我们直接让 BT 客户端使用互联网上的 tracker 列表就行。</p></div></article><article class="article"><header class="title">Python 3.12的一个破坏兼容性的更改：移除distutils</header><hr><div class="article-info"><!----><span class="date">Date: 6/10/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近使用 Python 3.12 import keras 的时候，遇到了如下的错误：</p>
<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">ModuleNotFoundError: No module named 'distutils'</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">非日本居民能够使用的日本服务</header><hr><div class="article-info"><!----><span class="date">Date: 6/8/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>本文列举了一些非日本居民也能够使用的日本服务（网购、预约系统等等）。非日本居民使用日本服务最大的障碍主要是手机号码。有些日本服务需要日本手机号码的短信验证才能够使用，而非日本居民是无法获得日本手机号码的。</p>
<h2>网购</h2>
<p><a href="https://www.suruga-ya.jp/" target="_blank" rel="noopener noreferrer">駿河屋</a>：注册账号的时候需要填写日本电话号码和住址，不过乱填也可以。支付时可以用 PayPal 刷信用卡。</p>
<h2>卡拉 OK</h2>
<p>日本的卡拉 OK 不需要注册会员就可以用，但是会员往往会有优惠价，所以这里列举的是可以注册会员的店铺。</p></div></article><article class="article"><header class="title">实用软件推荐</header><hr><div class="article-info"><!----><span class="date">Date: 5/21/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>二进制编辑器、PE 文件解析器等</h2>
<p><a href="https://hexed.it/" target="_blank" rel="noopener noreferrer">HexEd.it</a>：一个在线二进制编辑器。</p>
<p><a href="https://github.com/hasherezade/pe-bear" target="_blank" rel="noopener noreferrer">PE-bear</a>：开源的 PE 文件解析器。</p>
<p><a href="https://www.angusj.com/resourcehacker/" target="_blank" rel="noopener noreferrer">Resource Hacker</a>：编辑、提取 PE 文件的资源（.rsrc section）。</p></div></article><article class="article"><header class="title">关于Python的from future import annotations</header><hr><div class="article-info"><!----><span class="date">Date: 5/20/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>在默认情况下，Python 的 type hints 的值是真正的对象。请看下面的例子：</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">int</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">return</span> a <span class="token operator">+</span> b</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">.</span>__annotations__<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># output:</span></span>
<span class="line"><span class="token comment"># {'a': &lt;class 'int'&gt;, 'b': &lt;class 'int'&gt;, 'return': &lt;class 'int'&gt;}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">关于LaTeX的各种算法伪代码宏包</header><hr><div class="article-info"><!----><span class="date">Date: 5/19/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>在用 LaTeX 描述算法的时候，经常会用到 algorithm、algorithmic、algorithmicx、algpseudocode、algcompatible、algorithm2e 等各种宏包。这些宏包关系比较复杂，并且用法也存在差异，经常会引发混淆。本文就对这些宏包的作用进行简要的介绍。</p>
<p>首先，这些宏包可以分为两大类，algorithm2e 单独算作一类，而其他的是另一类。任何算法都可以分为算法标题和算法主体两个部分。对于 algorithm2e 宏包而言，算法标题和算法主体都通过 algorithm 环境来实现。而对于其他的宏包来说，算法标题通过 algorithm 环境实现，算法主体通过 algorithmic 环境实现。也就是说，如果你用的是 algorithm2e 宏包，那么你的算法代码大概就是下面这样：</p></div></article><article class="article"><header class="title">Python循环语句中的else子句</header><hr><div class="article-info"><!----><span class="date">Date: 5/16/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>Python 的循环语句（while 和 for 语句）有一个特殊的语法，就是它们支持 else 子句。下面用一个例子来说明其作用。</p>
<div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">for</span> i <span class="token keyword">in</span> a<span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">if</span> find<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        do_something<span class="token punctuation">(</span>i<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">break</span></span>
<span class="line"><span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">    not_found<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">管理Windows“添加或删除程序”中的项目</header><hr><div class="article-info"><!----><span class="date">Date: 5/15/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>在 Windows 的控制面板中点击“添加或删除程序”，便会看到当前电脑中安装的程序。这些程序的信息实际上是存储在注册表中的<code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall</code>。这个注册表项下的每一个子项都代表了一个安装的程序。每个项记录的信息可以参见<a href="https://learn.microsoft.com/en-us/windows/win32/msi/uninstall-registry-key" target="_blank" rel="noopener noreferrer">微软的官方文档</a>。下面简要介绍关键的信息。下面提到的值类型都是字符串。</p></div></article><article class="article"><header class="title">《基于启动和脑电波实验研究普通话和闽南语连续变调词的储存模式》书摘</header><hr><div class="article-info"><!----><span class="date">Date: 5/15/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近粗略翻阅了一本学术著作《基于启动和脑电波实验研究普通话和闽南语连续变调词的储存模式》。书中第二章和第三章针对普通话和闽南话的变调规则做了一个实验。实验流程是这样的，以普通话的“3-3→2-3”规则（比如辅导 fu3dao3 实际上会念成 fu2dao3）为例。实验人员让被试者听一些词语，然后让被试者判断这些词语是不是真实存在的词语。在让被试者听一个词语之前，会播放这个词的第一字作为刺激。实验分为两组，第一组播放的刺激是变调前的发音，比如播放“辅导”之前会先播放“fu3”的声音。另一组则会提前播放变调后的发音，比如播放“辅导”之前会先播放“fu2”的声音。然后比较两组实验中被试者的反应时间和准确率。除了普通话的“3-3→2-3”规则，研究者还针对闽南语的“24→33”规则（例如“平等”）和“51→55”规则（例如“主持”）也做了相同的实验。</p></div></article><article class="article"><header class="title">1932-1939年的台语歌曲</header><hr><div class="article-info"><!----><span class="date">Date: 5/15/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>最近阅读了厦门大学出版社出版的《传播与流变: 海峡两岸闽南语歌曲研究》，发现 91 页有一个表格，列举了所有 1932-1939 年的台语歌曲。于是我便在 YouTube Music 上建立了<a href="https://music.youtube.com/playlist?list=PLjJvx372ZSwVyV4QIobEW8sg_PXNus5RY&amp;si=7-SCelc4h2IjIuwB" target="_blank" rel="noopener noreferrer">一个歌单</a>，收集了表格中的经典台语歌曲。由于 YouTube Music 音源有限，因此遗漏了一些歌曲。这些缺失的歌曲可以在<a href="https://audio.nmth.gov.tw/audio" target="_blank" rel="noopener noreferrer">台湾声音一百年</a>里面找到。</p></div></article><article class="article"><header class="title">允许UWP应用访问localhost</header><hr><div class="article-info"><!----><span class="date">Date: 5/12/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>由于 Windows 的安全限制，UWP 应用默认是不能访问 localhost 的。这会导致 UWP 应用无法翻墙。要允许 UWP 应用访问 localhost，就必须修改注册表。GitHub 上有人编写了一个 GUI 程序，可以帮助我们修改注册表来解除限制。原作者的仓库地址在<a href="https://github.com/tiagonmas/Windows-Loopback-Exemption-Manager" target="_blank" rel="noopener noreferrer">这里</a>。可惜的是，原作者只提供了源代码，而没有提供编译好的可执行文件。不过好在 GitHub 上有人 fork 了仓库，提供了<a href="https://github.com/piksel/Windows-Loopback-Exemption-Manager/releases/tag/v1.0.0.1" target="_blank" rel="noopener noreferrer">编译好的可执行文件</a>。</p></div></article><article class="article"><header class="title">使用date命令生成ISO 8601格式的当前时间</header><hr><div class="article-info"><!----><span class="date">Date: 5/11/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>在很多场合可以看到形如 2024-05-11T17:27:12+08:00 的时间字符串。这是用 ISO 8601 格式表示的时间。字符串中的“T”是日期和时间和分隔符，而“+08:00”是时间的偏移量，也就是说时区是东八区。</p>
<p>在 Linux 下，可以使用 date 命令快速生成 ISO 8601 格式的当前时间：</p>
<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">date --iso-8601=seconds</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">在shebang中使用/usr/bin/env</header><hr><div class="article-info"><!----><span class="date">Date: 5/11/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>假设我们要编写一个 bash 脚本，很多人会这么写 shebang：</p>
<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">#!/bin/bash</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">用Makefile编写生成多个目标文件的规则</header><hr><div class="article-info"><!----><span class="date">Date: 4/27/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>假设现在有一个命令 cmd，它会读取文件 a，然后生成文件 x 和 y。</p>
<div class="language-c line-numbers-mode" data-highlighter="prismjs" data-ext="c"><pre><code><span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Reading a."</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cat a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Creating x and y."</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"touch x y"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">使用screen命令在后台运行进程</header><hr><div class="article-info"><!----><span class="date">Date: 4/26/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>谈到在后台运行进程，大多数人第一个想到的可能是直接在命令后面加一个&amp;，这么做有一些缺点：</p>
<ol>
<li>需要强行终止进程的时候，必须记住或者查询进程的名称、ID 等等。</li>
<li>有时候使用&amp;似乎会导致一个奇怪的 bug，使得终端输出紊乱甚至无法使用（参见<a href="https://askubuntu.com/questions/1459049/bash-script-launching-background-process-breaks-terminal-output-and-kills-backgr" target="_blank" rel="noopener noreferrer">这个 StackOverflow 问题</a>）。</li>
</ol></div></article><article class="article"><header class="title">Windows下用HTTP代理连接SSH</header><hr><div class="article-info"><!----><span class="date">Date: 4/23/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>这里假设使用的是 Git 提供的 SSH。首先打开 Git Bash，输入命令</p>
<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">where connect</span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div></div></article><article class="article"><header class="title">PowerShell脚本被禁止执行的解决方法</header><hr><div class="article-info"><!----><span class="date">Date: 4/9/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<p>在 Windows 中执行 PowerShell 脚本的时候，默认情况下会得到下面的错误信息：</p>
<blockquote>
<p>无法加载文件 xxx.ps1，因为在此系统上禁止运行脚本。有关详细信息，请参阅 https:/go.microsoft.com/fwlink/?LinkID=135170 中的 about_Execution_Policies。</p>
</blockquote>
<p>这是因为默认情况下，Windows 的 PowerShell 脚本执行策略是<code>Restricted</code>，也就是阻止运行任何脚本。要允许执行任意脚本，只需要将执行策略修改为<code>Unrestricted</code>即可：</p></div></article><article class="article"><header class="title">主机与VirtualBox虚拟机的网络通信配置</header><hr><div class="article-info"><!----><span class="date">Date: 3/15/2024</span><span class="category">Category: </span><span class="tag">Tag: </span></div><div class="excerpt">
<h2>虚拟机连接主机</h2>
<p>VirtualBox 已经默认建立了一个网卡，可以通过这个网卡和主机通信。</p>
<p>首先点击菜单栏的“管理”-&gt;“工具”-&gt;“网络管理器”。</p>
<p></p>
<p>然后就可以在“仅主机(Host-Only)网络”里看到网卡的 IP 地址。图中所示的地址是 192.168.56.1。</p>
<p></p>
<h2>主机连接虚拟机</h2>
<p>VirtualBox 默认的 NAT 网络只能支持虚拟机与主机或外网通信，主机是无法与虚拟机通信的。有时候我们需要让主机与虚拟机通信，比如让主机连接虚拟机的 SSH 等等。这种情况下，我们需要手动配置 VirtualBox 的端口转发。</p></div></article><!--]--></div></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-DEX1Ewll.js" defer></script>
  </body>
</html>
